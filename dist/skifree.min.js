!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);throw(f=new Error("Cannot find module '"+i+"'")).code="MODULE_NOT_FOUND",f}c=n[i]={exports:{}},e[i][0].call(c.exports,function(r){return o(e[i][1][r]||r)},c,c.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){CanvasRenderingContext2D.prototype.storeLoadedImage=function(key,image){this.images||(this.images={}),this.images[key]=image},CanvasRenderingContext2D.prototype.getLoadedImage=function(key){if(this.images[key])return this.images[key]},CanvasRenderingContext2D.prototype.followSprite=function(sprite){this.centralSprite=sprite},CanvasRenderingContext2D.prototype.getCentralPosition=function(){return{map:this.centralSprite.mapPosition,canvas:[Math.round(.5*this.canvas.width),Math.round(.5*this.canvas.height),0]}},CanvasRenderingContext2D.prototype.mapPositionToCanvasPosition=function(position){var central=this.getCentralPosition(),centralMapPosition=central.map,central=central.canvas,mapDifferenceX=centralMapPosition[0]-position[0],centralMapPosition=centralMapPosition[1]-position[1];return[central[0]-mapDifferenceX,central[1]-centralMapPosition]},CanvasRenderingContext2D.prototype.canvasPositionToMapPosition=function(position){var central=this.getCentralPosition(),centralMapPosition=central.map,central=central.canvas,mapDifferenceX=central[0]-position[0],central=central[1]-position[1];return[centralMapPosition[0]-mapDifferenceX,centralMapPosition[1]-central]},CanvasRenderingContext2D.prototype.getCentreOfViewport=function(){return(this.canvas.width/2).floor()},CanvasRenderingContext2D.prototype.getMiddleOfViewport=function(){return(this.canvas.height/2).floor()},CanvasRenderingContext2D.prototype.getBelowViewport=function(){return this.canvas.height.floor()},CanvasRenderingContext2D.prototype.getMapBelowViewport=function(){var below=this.getBelowViewport();return this.canvasPositionToMapPosition([0,below])[1]},CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfCanvas=function(buffer){var min=0,max=this.canvas.width;return buffer&&(min-=buffer,max+=buffer),Number.random(min,max)},CanvasRenderingContext2D.prototype.getRandomlyInTheCentreOfMap=function(buffer){buffer=this.getRandomlyInTheCentreOfCanvas(buffer);return this.canvasPositionToMapPosition([buffer,0])[0]},CanvasRenderingContext2D.prototype.getRandomMapPositionBelowViewport=function(){var xCanvas=this.getRandomlyInTheCentreOfCanvas(),yCanvas=this.getBelowViewport();return this.canvasPositionToMapPosition([xCanvas,yCanvas])},CanvasRenderingContext2D.prototype.getRandomMapPositionAboveViewport=function(){var xCanvas=this.getRandomlyInTheCentreOfCanvas(),yCanvas=this.getAboveViewport();return this.canvasPositionToMapPosition([xCanvas,yCanvas])},CanvasRenderingContext2D.prototype.getTopOfViewport=function(){return this.canvasPositionToMapPosition([0,0])[1]},CanvasRenderingContext2D.prototype.getAboveViewport=function(){return 0-(this.canvas.height/4).floor()}},{}],2:[function(require,module,exports){Function.prototype.method=function(name,func){return this.prototype[name]=func,this},Object.method("superior",function(name){var that=this,method=that[name];return function(){return method.apply(that,arguments)}})},{}],3:[function(require,module,exports){var SpriteArray=require("./spriteArray"),EventedLoop=require("eventedloop"),isMobileDevice=require("../lib/isMobileDevice");require("./sprite");this.game=function(mainCanvas,player){var staticObjects=new SpriteArray,movingObjects=new SpriteArray,uiElements=new SpriteArray,dContext=mainCanvas.getContext("2d"),showHitBoxes=!1,isMobile=isMobileDevice(),backgroundImage=new Image,backgroundX=(backgroundImage.src="assets/background.png",0),backgroundY=0,hudImage=new Image,mouseX=(hudImage.src=isMobile?"assets/mockups/mobilehud-mockup.png":"assets/mockups/hud-mockup.png",dContext.getCentreOfViewport()),mouseY=0,paused=!1,beforeCycleCallbacks=[],afterCycleCallbacks=[],gameLoop=new EventedLoop;this.toggleHitBoxes=function(){showHitBoxes=!showHitBoxes,staticObjects.each(function(sprite){sprite.setHitBoxesVisible(showHitBoxes)})},this.addStaticObject=function(sprite){sprite.setHitBoxesVisible(showHitBoxes),staticObjects.push(sprite)},this.addStaticObjects=function(sprites){sprites.forEach(this.addStaticObject.bind(this))},this.addMovingObject=function(movingObject,movingObjectType){movingObjectType&&staticObjects.onPush(function(obj){obj.data&&obj.data.hitBehaviour[movingObjectType]&&obj.onHitting(movingObject,obj.data.hitBehaviour[movingObjectType])},!0),movingObject.setHitBoxesVisible(showHitBoxes),movingObjects.push(movingObject)},this.addUIElement=function(element){uiElements.push(element)},this.beforeCycle=function(callback){beforeCycleCallbacks.push(callback)},this.afterCycle=function(callback){afterCycleCallbacks.push(callback)},this.setMouseX=function(x){mouseX=x},this.setMouseY=function(y){mouseY=y},player.setMapPosition(0,0),player.setMapPositionTarget(0,-10),dContext.followSprite(player),this.cycle=function(){beforeCycleCallbacks.each(function(c){c()});var mouseMapPosition=dContext.canvasPositionToMapPosition([mouseX,mouseY]);player.isJumping||player.setMapPositionTarget(mouseMapPosition[0],mouseMapPosition[1]),player.cycle(),movingObjects.each(function(movingObject,i){movingObject.cycle(dContext)}),staticObjects.cull(),staticObjects.each(function(staticObject,i){staticObject.cycle&&staticObject.cycle()}),uiElements.each(function(uiElement,i){uiElement.cycle&&uiElement.cycle()}),afterCycleCallbacks.each(function(c){c()})},this.draw=function(){var imgWidth,screenWidth,scaleX,imgHeight,screenHeight,scaleY;mainCanvas.width=mainCanvas.width,backgroundImage.width=mainCanvas.width,backgroundImage.height=mainCanvas.height,backgroundX=player.mapPosition[0]%backgroundImage.width*-1,backgroundY=player.mapPosition[1]%backgroundImage.height*-1,dContext.drawImage(backgroundImage,backgroundX,backgroundY,mainCanvas.width,backgroundImage.height),dContext.drawImage(backgroundImage,backgroundX+mainCanvas.width,backgroundY,mainCanvas.width,backgroundImage.height),dContext.drawImage(backgroundImage,backgroundX-mainCanvas.width,backgroundY,mainCanvas.width,backgroundImage.height),dContext.drawImage(backgroundImage,backgroundX,backgroundY+mainCanvas.height,mainCanvas.width,backgroundImage.height),dContext.drawImage(backgroundImage,backgroundX+mainCanvas.width,backgroundY+mainCanvas.height,mainCanvas.width,backgroundImage.height),dContext.drawImage(backgroundImage,backgroundX-mainCanvas.width,backgroundY+mainCanvas.height,mainCanvas.width,backgroundImage.height),player.setHitBoxesVisible(showHitBoxes),player.draw(dContext),player.cycle(),movingObjects.each(function(movingObject,i){movingObject.draw(dContext)}),staticObjects.each(function(staticObject,i){staticObject.draw&&staticObject.draw(dContext,"main")}),uiElements.each(function(uiElement,i){uiElement.draw&&uiElement.draw(dContext,"main")}),isMobile?(imgWidth=hudImage.naturalWidth,screenWidth=mainCanvas.width,scaleX=1,imgHeight=hudImage.naturalHeight,screenHeight=mainCanvas.height,scaleY=1,screenHeight=scaleY=screenHeight<imgHeight?screenHeight/imgHeight:scaleY,(screenHeight=(scaleX=screenWidth<imgWidth?screenWidth/imgWidth:scaleX)<scaleY?scaleX:screenHeight)<1&&(imgHeight*=screenHeight,imgWidth*=screenHeight),dContext.drawImage(hudImage,0,0,hudImage.naturalWidth,hudImage.naturalHeight,0,0,imgWidth,imgHeight)):dContext.drawImage(hudImage,0,0,mainCanvas.width,hudImage.height,0,0,mainCanvas.width,hudImage.height)},this.start=function(){gameLoop.start()},this.pause=function(){paused=!0,gameLoop.stop()},this.isPaused=function(){return paused},this.reset=function(){paused=!1,staticObjects=new SpriteArray,movingObjects=new SpriteArray,mouseX=dContext.getCentreOfViewport(),mouseY=0,player.reset(),player.setMapPosition(0,0,0),this.start()}.bind(this),gameLoop.on("20",this.cycle),gameLoop.on("20",this.draw)},void 0!==module&&(module.exports=this.game)},{"../lib/isMobileDevice":6,"./sprite":11,"./spriteArray":12,eventedloop:16}],4:[function(require,module,exports){this.guid=function(){function S4(){return Math.floor(65536*Math.random()).toString(16)}return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()},void 0!==module&&(module.exports=this.guid)},{}],5:[function(require,module,exports){void 0!==module&&(module.exports=function(data){var that=this;return that.lines=data.initialLines,that.top=data.position.top,that.right=data.position.right,that.bottom=data.position.bottom,that.left=data.position.left,that.width=data.width,that.height=data.height,that.setLines=function(lines){that.lines=lines},that.draw=function(dContext){dContext.font="11px monospace";var yOffset=0;that.lines.each(function(line){var xPos,yPos,fontSize=+dContext.font.slice(0,2),textWidth=dContext.measureText(line).width,fontSize=1.5*fontSize;that.top?yPos=that.top+yOffset:that.bottom&&(yPos=dContext.canvas.height-that.top-fontSize+yOffset),that.right?xPos=dContext.canvas.width-that.right-textWidth:that.left&&(xPos=that.left),yOffset+=fontSize,dContext.fillStyle="#ffffff",dContext.fillText(line,xPos,yPos)})},that})},{}],6:[function(require,module,exports){module.exports=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))}},{}],7:[function(require,module,exports){var Sprite=require("./sprite");this.monster=function(data){var that=new Sprite(data),super_draw=that.superior("draw"),spriteVersion=1,eatingStage=0;return that.isEating=!1,that.isFull=!1,that.setSpeed(6),that.draw=function(dContext){return super_draw(dContext,(dContext=that.movingToward[0]-that.canvasX,that.isEating?"eating"+eatingStage:(2<spriteVersion+.1?spriteVersion=.1:spriteVersion+=.1,0<=dContext?"sEast"+Math.ceil(spriteVersion):dContext<0?"sWest"+Math.ceil(spriteVersion):void 0)))},that.startEating=function startEating(whenDone){eatingStage+=1,that.isEating=!0,that.isMoving=!1,eatingStage<6?setTimeout(function(){startEating(whenDone)},300):(eatingStage=0,that.isEating=!1,that.isMoving=!0,whenDone())},that},void 0!==module&&(module.exports=this.monster)},{"./sprite":11}],8:[function(require,module,exports){var Sprite=require("./sprite");"undefined"!=typeof navigator?navigator.vibrate=navigator.vibrate||navigator.webkitVibrate||navigator.mozVibrate||navigator.msVibrate:navigator={vibrate:!1},this.player=function(data){var cancelableStateTimeout,cancelableStateInterval,discreteDirections={west:270,wsWest:240,sWest:195,south:180,sEast:165,esEast:120,east:90},that=new Sprite(data),sup={draw:that.superior("draw"),cycle:that.superior("cycle"),getSpeedX:that.superior("getSpeedX"),getSpeedY:that.superior("getSpeedY"),hits:that.superior("hits")},directions_esEast=function(xDiff){return 300<xDiff},directions_sEast=function(xDiff){return 75<xDiff},directions_wsWest=function(xDiff){return xDiff<-300},directions_sWest=function(xDiff){return xDiff<-75},canSpeedBoost=!0,obstaclesHit=[],pixelsTravelled=0,turnEaseCycles=70,speedX=0,speedXFactor=0,speedY=0,speedYFactor=1,trickStep=0;function setNormal(){that.setSpeed(5),that.isMoving=!0,that.hasBeenHit=!1,that.isJumping=!1,that.isPerformingTrick=!1,cancelableStateInterval&&clearInterval(cancelableStateInterval),that.setMapPosition(void 0,void 0,0)}function getDiscreteDirection(){if(that.direction)return that.direction<=90?"east":90<that.direction&&that.direction<150?"esEast":150<=that.direction&&that.direction<180?"sEast":180===that.direction?"south":180<that.direction&&that.direction<=210?"sWest":210<that.direction&&that.direction<270?"wsWest":270<=that.direction?"west":"south";var xDiff=that.movingToward[0]-that.mapPosition[0];return that.movingToward[1]-that.mapPosition[1]<=0?0<xDiff?"east":"west":directions_esEast(xDiff)?"esEast":directions_sEast(xDiff)?"sEast":directions_wsWest(xDiff)?"wsWest":directions_sWest(xDiff)?"sWest":"south"}function setDiscreteDirection(d){discreteDirections[d]&&that.setDirection(discreteDirections[d]),that.isMoving="west"!==d&&"east"!==d}function easeSpeedToTargetUsingFactor(sp,targetSpeed,f){return 0===f||1===f?targetSpeed:(sp<targetSpeed&&(sp+=that.getSpeed()*(f/turnEaseCycles)),targetSpeed<sp&&(sp-=that.getSpeed()*(f/turnEaseCycles)),sp)}return that.isMoving=!0,that.hasBeenHit=!1,that.isJumping=!1,that.isPerformingTrick=!1,that.onHitObstacleCb=function(){},that.setSpeed(5),that.reset=function(){obstaclesHit=[],pixelsTravelled=0,that.isMoving=!0,that.hasBeenHit=!1,canSpeedBoost=!0,setNormal()},that.stop=function(){180<that.direction?setDiscreteDirection("west"):setDiscreteDirection("east")},that.turnEast=function(){switch(getDiscreteDirection()){case"west":setDiscreteDirection("wsWest");break;case"wsWest":setDiscreteDirection("sWest");break;case"sWest":setDiscreteDirection("south");break;case"south":setDiscreteDirection("sEast");break;case"sEast":setDiscreteDirection("esEast");break;case"esEast":setDiscreteDirection("east");break;default:setDiscreteDirection("south")}},that.turnWest=function(){switch(getDiscreteDirection()){case"east":setDiscreteDirection("esEast");break;case"esEast":setDiscreteDirection("sEast");break;case"sEast":setDiscreteDirection("south");break;case"south":setDiscreteDirection("sWest");break;case"sWest":setDiscreteDirection("wsWest");break;case"wsWest":setDiscreteDirection("west");break;default:setDiscreteDirection("south")}},that.stepWest=function(){that.mapPosition[0]-=2*that.speed},that.stepEast=function(){that.mapPosition[0]+=2*that.speed},that.setMapPositionTarget=function(x,y){that.hasBeenHit||(Math.abs(that.mapPosition[0]-x)<=75&&(x=that.mapPosition[0]),that.movingToward=[x,y])},that.startMovingIfPossible=function(){that.hasBeenHit||that.isBeingEaten||(that.isMoving=!0)},that.setTurnEaseCycles=function(c){turnEaseCycles=c},that.getPixelsTravelledDownMountain=function(){return pixelsTravelled},that.resetSpeed=function(){that.setSpeed(5)},that.cycle=function(){that.getSpeedX()<=0&&that.getSpeedY()<=0&&(that.isMoving=!1),that.isMoving&&(pixelsTravelled+=that.speed),that.isJumping&&that.setMapPositionTarget(void 0,that.mapPosition[1]+that.getSpeed()),sup.cycle(),that.checkHittableObjects()},that.draw=function(dContext){return sup.draw(dContext,that.isBeingEaten?"blank":that.isJumping?that.isPerformingTrick?(console.log("Trick step is",trickStep),0===trickStep?"jumping":1===trickStep?"somersault1":"somersault2"):"jumping":that.hasBeenHit?"hit":getDiscreteDirection())},that.hits=function(obs){return-1===obstaclesHit.indexOf(obs.id)&&(!!obs.occupiesZIndex(that.mapPosition[2])&&!!sup.hits(obs))},that.speedBoost=function(){var originalSpeed=that.speed;canSpeedBoost&&(canSpeedBoost=!1,that.setSpeed(2*that.speed),setTimeout(function(){that.setSpeed(originalSpeed),setTimeout(function(){canSpeedBoost=!0},1e4)},2e3))},that.attemptTrick=function(){that.isJumping&&(that.isPerformingTrick=!0,cancelableStateInterval=setInterval(function(){2<=trickStep?trickStep=0:trickStep+=1},300))},that.getStandardSpeed=function(){return 5},that.getSpeedX=function(){return speedX="esEast"===getDiscreteDirection()||"wsWest"===getDiscreteDirection()?(speedXFactor=.5,easeSpeedToTargetUsingFactor(speedX,that.getSpeed()*speedXFactor,speedXFactor)):"sEast"===getDiscreteDirection()||"sWest"===getDiscreteDirection()?(speedXFactor=.33,easeSpeedToTargetUsingFactor(speedX,that.getSpeed()*speedXFactor,speedXFactor)):easeSpeedToTargetUsingFactor(speedX,0,speedXFactor)},that.setSpeedY=function(sy){speedY=sy},that.getSpeedY=function(){return that.isJumping?speedY:speedY="esEast"===getDiscreteDirection()||"wsWest"===getDiscreteDirection()?easeSpeedToTargetUsingFactor(speedY,(speedYFactor=.6)*that.getSpeed(),.6):"sEast"===getDiscreteDirection()||"sWest"===getDiscreteDirection()?easeSpeedToTargetUsingFactor(speedY,(speedYFactor=.85)*that.getSpeed(),.85):"east"===getDiscreteDirection()||"west"===getDiscreteDirection()?(speedYFactor=1,0):easeSpeedToTargetUsingFactor(speedY,that.getSpeed(),speedYFactor)},that.hasHitObstacle=function(obs){that.isMoving=!1,that.hasBeenHit=!0,that.isJumping=!1,that.isPerformingTrick=!1,cancelableStateInterval&&clearInterval(cancelableStateInterval),that.setMapPosition(void 0,void 0,0),navigator.vibrate&&navigator.vibrate(500),obstaclesHit.push(obs.id),that.resetSpeed(),that.onHitObstacleCb(obs),cancelableStateTimeout&&clearTimeout(cancelableStateTimeout),cancelableStateTimeout=setTimeout(function(){setNormal()},1500)},that.hasHitJump=function(){var currentSpeed;currentSpeed=that.getSpeed(),that.setSpeed(currentSpeed+2),that.setSpeedY(currentSpeed+2),that.isMoving=!0,that.hasBeenHit=!1,that.isJumping=!0,that.setMapPosition(void 0,void 0,1),cancelableStateTimeout&&clearTimeout(cancelableStateTimeout),cancelableStateTimeout=setTimeout(function(){setNormal()},1e3)},that.isEatenBy=function(monster,whenEaten){that.hasHitObstacle(monster),monster.startEating(whenEaten),obstaclesHit.push(monster.id),that.isMoving=!1,that.isBeingEaten=!0},that.reset=function(){obstaclesHit=[],pixelsTravelled=0,that.isMoving=!0,that.isJumping=!1,that.hasBeenHit=!1,canSpeedBoost=!0},that.setHitObstacleCb=function(fn){that.onHitObstacleCb=fn||function(){}},that},void 0!==module&&(module.exports=this.player)},{"./sprite":11}],9:[function(require,module,exports){function noop(){}for(var method,methods=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],length=methods.length,console=window.console=window.console||{};length--;)console[method=methods[length]]||(console[method]=noop)},{}],10:[function(require,module,exports){var Sprite=require("./sprite");this.snowboarder=function(data){var that=new Sprite(data),sup={draw:that.superior("draw"),cycle:that.superior("cycle")},directions={sEast:function(xDiff){return 0<xDiff},sWest:function(xDiff){return xDiff<=0}};return that.setSpeed(3),that.cycle=function(dContext){1===Number.random(10)&&(that.setMapPositionTarget(dContext.getRandomlyInTheCentreOfMap()),that.setSpeed(3+Number.random(-1,1))),that.setMapPositionTarget(void 0,dContext.getMapBelowViewport()+600),sup.cycle()},that.draw=function(dContext){return sup.draw(dContext,(dContext=that.movingToward[0]-that.mapPosition[0],that.movingToward[1],that.mapPosition[1],directions.sEast(dContext)?"sEast":"sWest"))},that},void 0!==module&&(module.exports=this.snowboarder)},{"./sprite":11}],11:[function(require,module,exports){function Sprite(data){var trackedSpriteToMoveToward,hittableObjects={},zIndexesOccupied=[0],that=this,showHitBoxes=!1;function getHitBox(forZIndex){if(that.data.hitBoxes&&data.hitBoxes[forZIndex])return data.hitBoxes[forZIndex]}function roundHalf(num){return num=Math.round(2*num)/2}return that.direction=void 0,that.mapPosition=[0,0,0],that.id=GUID(),that.canvasX=0,that.canvasY=0,that.canvasZ=0,that.height=0,that.speed=0,that.data=data||{parts:{}},that.movingToward=[0,0],that.metresDownTheMountain=0,that.movingWithConviction=!1,that.deleted=!1,that.maxHeight=Object.values(that.data.parts).map(function(p){return p[3]}).max(),that.isMoving=!0,that.data.parts||(that.data.parts={}),data&&data.id&&(that.id=data.id),data&&data.zIndexesOccupied&&(zIndexesOccupied=data.zIndexesOccupied),this.setHitBoxesVisible=function(show){showHitBoxes=show},this.draw=function(dCtx,spriteFrame){var left,top,right,hitBox,spriteFrame=that.data.parts[spriteFrame],newCanvasPosition=(that.height=spriteFrame[3],that.width=spriteFrame[2],dCtx.mapPositionToCanvasPosition(that.mapPosition));if(that.setCanvasPosition(newCanvasPosition[0],newCanvasPosition[1]),dCtx.drawImage(dCtx.getLoadedImage(that.data.$imageFile),spriteFrame[0],spriteFrame[1],spriteFrame[2],spriteFrame[3],that.canvasX,that.canvasY,spriteFrame[2],spriteFrame[3]),showHitBoxes)for(const box in that.data.hitBoxes)Object.hasOwnProperty.call(that.data.hitBoxes,box)&&(left=(hitBox=that.data.hitBoxes[box])[0],top=hitBox[1],right=hitBox[2],hitBox=hitBox[3],dCtx.strokeStyle="yellow",dCtx.strokeRect(that.canvasX+left,that.canvasY+top,right-left,hitBox-top))},this.setMapPosition=function(x,y,z){void 0===x&&(x=that.mapPosition[0]),void 0===y&&(y=that.mapPosition[1]),void 0===z?z=that.mapPosition[2]:that.zIndexesOccupied=[z],that.mapPosition=[x,y,z]},this.setCanvasPosition=function(cx,cy){cx&&(!Object.isString(cx)||"+"!==cx.first()&&"-"!==cx.first()?that.canvasX=cx:that.canvasX+=cx.toNumber()),cy&&(!Object.isString(cy)||"+"!==cy.first()&&"-"!==cy.first()?that.canvasY=cy:function(amount){that.canvasY+=amount.toNumber()}(cy))},this.getCanvasPositionX=function(){return that.canvasX},this.getCanvasPositionY=function(){return that.canvasY},this.getLeftHitBoxEdge=function(zIndex){zIndex=zIndex||0;var lhbe=this.getCanvasPositionX();return getHitBox(zIndex)&&(lhbe+=getHitBox(zIndex)[0]),lhbe},this.getTopHitBoxEdge=function(zIndex){zIndex=zIndex||0;var thbe=this.getCanvasPositionY();return getHitBox(zIndex)&&(thbe+=getHitBox(zIndex)[1]),thbe},this.getRightHitBoxEdge=function(zIndex){return getHitBox(zIndex=zIndex||0)?that.canvasX+getHitBox(zIndex)[2]:that.canvasX+that.width},this.getBottomHitBoxEdge=function(zIndex){return getHitBox(zIndex=zIndex||0)?that.canvasY+getHitBox(zIndex)[3]:that.canvasY+that.height},this.getPositionInFrontOf=function(){return[that.canvasX,that.canvasY+that.height]},this.setSpeed=function(s){that.speed=s,that.speedX=s,that.speedY=s},this.incrementSpeedBy=function(s){that.speed+=s},that.getSpeed=function(){return that.speed},that.getSpeedX=function(){return that.speed},that.getSpeedY=function(){return that.speed},this.setHeight=function(h){that.height=h},this.setWidth=function(w){that.width=w},this.getMaxHeight=function(){return that.maxHeight},that.getMovingTowardOpposite=function(){if(!that.isMoving)return[0,0];var dx=that.movingToward[0]-that.mapPosition[0],dy=that.movingToward[1]-that.mapPosition[1];return[75<Math.abs(dx)?0-dx:0,-dy]},this.checkHittableObjects=function(){Object.keys(hittableObjects,function(k,objectData){objectData.object.deleted?delete hittableObjects[k]:objectData.object.hits(that)&&objectData.callbacks.each(function(callback){callback(that,objectData.object)})})},this.cycle=function(){var currentX,currentY,d;that.checkHittableObjects(),trackedSpriteToMoveToward&&that.setMapPositionTarget(trackedSpriteToMoveToward.mapPosition[0],trackedSpriteToMoveToward.mapPosition[1],!0),that.isMoving&&(currentX=that.mapPosition[0],currentY=that.mapPosition[1],void 0!==that.direction?((d=that.direction-90)<0&&(d=360+d),currentX+=roundHalf(that.speed*Math.cos(d*(Math.PI/180))),currentY+=roundHalf(that.speed*Math.sin(d*(Math.PI/180)))):(void 0!==that.movingToward[0]&&(currentX>that.movingToward[0]?currentX-=Math.min(that.getSpeedX(),Math.abs(currentX-that.movingToward[0])):currentX<that.movingToward[0]&&(currentX+=Math.min(that.getSpeedX(),Math.abs(currentX-that.movingToward[0])))),void 0!==that.movingToward[1]&&(currentY>that.movingToward[1]?currentY-=Math.min(that.getSpeedY(),Math.abs(currentY-that.movingToward[1])):currentY<that.movingToward[1]&&(currentY+=Math.min(that.getSpeedY(),Math.abs(currentY-that.movingToward[1]))))),that.setMapPosition(currentX,currentY))},this.setMapPositionTarget=function(x,y,override){override&&(that.movingWithConviction=!1),that.movingWithConviction||(void 0===x&&(x=that.movingToward[0]),void 0===y&&(y=that.movingToward[1]),that.movingToward=[x,y],that.movingWithConviction=!1)},this.setDirection=function(angle){that.direction=angle=360<=angle?360-angle:angle,that.movingToward=void 0},this.resetDirection=function(){that.direction=void 0},this.setMapPositionTargetWithConviction=function(cx,cy){that.setMapPositionTarget(cx,cy),that.movingWithConviction=!0},this.follow=function(sprite){trackedSpriteToMoveToward=sprite},this.stopFollowing=function(){trackedSpriteToMoveToward=!1},this.onHitting=function(objectToHit,callback){if(hittableObjects[objectToHit.id])return hittableObjects[objectToHit.id].callbacks.push(callback);hittableObjects[objectToHit.id]={object:objectToHit,callbacks:[callback]}},this.deleteOnNextCycle=function(){that.deleted=!0},this.occupiesZIndex=function(z){return 0<=zIndexesOccupied.indexOf(z)},this.hits=function(other){var verticalIntersect=!1,horizontalIntersect=!1;return other.getTopHitBoxEdge(that.mapPosition[2])<=that.getBottomHitBoxEdge(that.mapPosition[2])&&other.getBottomHitBoxEdge(that.mapPosition[2])>=that.getBottomHitBoxEdge(that.mapPosition[2])&&(verticalIntersect=!0),other.getTopHitBoxEdge(that.mapPosition[2])<=that.getTopHitBoxEdge(that.mapPosition[2])&&other.getBottomHitBoxEdge(that.mapPosition[2])>=that.getTopHitBoxEdge(that.mapPosition[2])&&(verticalIntersect=!0),other.getLeftHitBoxEdge(that.mapPosition[2])<=that.getRightHitBoxEdge(that.mapPosition[2])&&other.getRightHitBoxEdge(that.mapPosition[2])>=that.getRightHitBoxEdge(that.mapPosition[2])&&(horizontalIntersect=!0),other.getLeftHitBoxEdge(that.mapPosition[2])<=that.getLeftHitBoxEdge(that.mapPosition[2])&&other.getRightHitBoxEdge(that.mapPosition[2])>=that.getLeftHitBoxEdge(that.mapPosition[2])&&(horizontalIntersect=!0),verticalIntersect&&horizontalIntersect},this.isAboveOnCanvas=function(cy){return that.canvasY+that.height<cy},this.isBelowOnCanvas=function(cy){return that.canvasY>cy},that}var global,GUID;global=this,GUID=require("./guid"),Sprite.createObjects=function(spriteInfoArray,opts){return Array.isArray(spriteInfoArray)||(spriteInfoArray=[spriteInfoArray]),opts=Object.merge(opts,{rateModifier:0,dropRate:1,position:[0,0]},!1,!1),spriteInfoArray.map(function(spriteInfo){var sprite,position=opts.position;if(Number.random(100+opts.rateModifier)<=spriteInfo.dropRate)return(sprite=new Sprite(spriteInfo.sprite)).setSpeed(0),Object.isFunction(position)&&(position=position()),sprite.setMapPosition(position[0],position[1]),spriteInfo.sprite.hitBehaviour&&spriteInfo.sprite.hitBehaviour.player&&opts.player&&sprite.onHitting(opts.player,spriteInfo.sprite.hitBehaviour.player),sprite}).remove(void 0)},global.sprite=Sprite,void 0!==module&&(module.exports=this.sprite)},{"./guid":4}],12:[function(require,module,exports){function SpriteArray(){return this.pushHandlers=[],this}var global;global=this,(SpriteArray.prototype=Object.create(Array.prototype)).onPush=function(f,retroactive){this.pushHandlers.push(f),retroactive&&this.each(f)},SpriteArray.prototype.push=function(obj){Array.prototype.push.call(this,obj),this.pushHandlers.each(function(handler){handler(obj)})},SpriteArray.prototype.cull=function(){this.each(function(obj,i){if(obj.deleted)return delete this[i]})},global.spriteArray=SpriteArray,void 0!==module&&(module.exports=this.spriteArray)},{}],13:[function(require,module,exports){require("./lib/canvasRenderingContext2DExtensions"),require("./lib/extenders"),require("./lib/plugins");var Mousetrap=require("br-mousetrap"),isMobileDevice=require("./lib/isMobileDevice"),Monster=(require("./lib/spriteArray"),require("./lib/monster")),Sprite=require("./lib/sprite"),Snowboarder=require("./lib/snowboarder"),Player=require("./lib/player"),InfoBox=require("./lib/infoBox"),Game=require("./lib/game"),mainCanvas=document.getElementById("game-canvas"),dContext=mainCanvas.getContext("2d"),infoBoxControls="Use the mouse or WASD to control the cart",sprites=(isMobileDevice()&&(infoBoxControls="Tap or drag on the road to control the cart"),require("./spriteInfo"));const Hammer=require("hammerjs");var pixelsPerMetre=18,monsterDistanceThreshold=2e3,livesLeft=5,highScore=0;const score={distance:0,money:0,tokens:0,points:0,cans:0,reset(){distance=0,money=0,tokens=0,points=0,cans=0}};var sources,next,loaded,images,loseLifeOnObstacleHit=!0,dropRates={smallTree:4,tallTree:2,jump:1,thickSnow:1,rock:1,token:1};function monsterHitsPlayerBehaviour(monster,player){player.isEatenBy(monster,function(){--livesLeft,monster.isFull=!0,monster.isEating=!1,player.isBeingEaten=!1,monster.setSpeed(player.getSpeed()),monster.stopFollowing();var randomPositionAbove=dContext.getRandomMapPositionAboveViewport();monster.setMapPositionTarget(randomPositionAbove[0],randomPositionAbove[1])})}function resizeCanvas(){mainCanvas.width=window.innerWidth,mainCanvas.height=window.innerHeight}function finish(){(loaded+=1)===sources.length&&next(images)}localStorage.getItem("highScore")&&(highScore=localStorage.getItem("highScore")),$(".credits").click(function(){$("#main").hide(),$("#credits").show(),$("#menu").addClass("credits")}),$(".back").click(function(){$("#credits").hide(),$("#main").show(),$("#menu").removeClass("credits")}),window.addEventListener("resize",resizeCanvas,!1),resizeCanvas(),next=function(images){var player,startSign,infoBox,game;function spawnMonster(){var newMonster=new Monster(sprites.monster),randomPosition=dContext.getRandomMapPositionAboveViewport();newMonster.setMapPosition(randomPosition[0],randomPosition[1]),newMonster.follow(player),newMonster.setSpeed(player.getStandardSpeed()),newMonster.onHitting(player,monsterHitsPlayerBehaviour),game.addMovingObject(newMonster,"monster")}(player=new Player(sprites.player)).setMapPosition(0,0),player.setMapPositionTarget(0,-10),player.setHitObstacleCb(function(){loseLifeOnObstacleHit&&--livesLeft}),game=new Game(mainCanvas,player),startSign=new Sprite(sprites.signStart),game.addStaticObject(startSign),startSign.setMapPosition(-50,0),dContext.followSprite(player),infoBox=new InfoBox({initialLines:[infoBoxControls,"Distance: 0m","High Score: "+highScore,"Carts left: "+livesLeft,"Brought to you by Serious Business",loseLifeOnObstacleHit?"":"God Mode"],position:{top:isMobileDevice()?90:130,right:10}}),game.beforeCycle(function(){var dropRate,rateModifier,newObjects=[];player.isMoving&&(newObjects=Sprite.createObjects([{sprite:sprites.smallTree,dropRate:dropRates.smallTree},{sprite:sprites.tallTree,dropRate:dropRates.tallTree},{sprite:sprites.jump,dropRate:dropRates.jump},{sprite:sprites.thickSnow,dropRate:dropRates.thickSnow},{sprite:sprites.rock,dropRate:dropRates.rock},{sprite:sprites.token,dropRate:dropRates.token}],{rateModifier:Math.max(800-mainCanvas.width,0),position:function(){return dContext.getRandomMapPositionBelowViewport()},player:player})),game.isPaused()||(game.addStaticObjects(newObjects),score.distance=parseFloat(player.getPixelsTravelledDownMountain()/pixelsPerMetre).toFixed(1),score.distance>monsterDistanceThreshold&&(newObjects=spawnMonster,dropRate=.001,rateModifier=Math.max(800-mainCanvas.width,0),Number.random(1e3+rateModifier)<=dropRate&&newObjects()),infoBox.setLines([infoBoxControls,"Distance: "+score.distance+"m","Carts left: "+livesLeft,"High Score: "+highScore,"Brought to you by Serious Business","Current Speed: "+player.getSpeed(),"Money: "+score.money,"Tokens: "+score.tokens,loseLifeOnObstacleHit?"":"GOD MODE"]))}),game.afterCycle(function(){0!==livesLeft||game.isPaused()||(highScore=localStorage.setItem("highScore",score.distance),infoBox.setLines(["Game over!","Hit space to restart"]),game.pause(),game.cycle())}),game.addUIElement(infoBox),$(mainCanvas).mousemove(function(e){game.setMouseX(e.pageX),game.setMouseY(e.pageY),player.resetDirection(),player.startMovingIfPossible()}).bind("click",function(e){game.setMouseX(e.pageX),game.setMouseY(e.pageY),player.resetDirection(),player.startMovingIfPossible()}).focus(),Mousetrap.bind("f",player.speedBoost),Mousetrap.bind("t",player.attemptTrick),Mousetrap.bind(["w","up"],function(){player.stop()}),Mousetrap.bind(["a","left"],function(){270===player.direction?player.stepWest():player.turnWest()}),Mousetrap.bind(["s","down"],function(){player.setDirection(180),player.startMovingIfPossible()}),Mousetrap.bind(["d","right"],function(){90===player.direction?player.stepEast():player.turnEast()}),Mousetrap.bind("m",spawnMonster),Mousetrap.bind("b",function(){var newBoarder=new Snowboarder(sprites.snowboarder),randomPositionAbove=dContext.getRandomMapPositionAboveViewport(),randomPositionBelow=dContext.getRandomMapPositionBelowViewport();newBoarder.setMapPosition(randomPositionAbove[0],randomPositionAbove[1]),newBoarder.setMapPositionTarget(randomPositionBelow[0],randomPositionBelow[1]),newBoarder.onHitting(player,sprites.snowboarder.hitBehaviour.player),game.addMovingObject(newBoarder)}),Mousetrap.bind("space",function(){livesLeft=5,highScore=localStorage.getItem("highScore"),game.reset(),game.addStaticObject(startSign),score.reset()}),Mousetrap.bind("g",function(){loseLifeOnObstacleHit=!loseLifeOnObstacleHit,console.log("God mode changed: "+!loseLifeOnObstacleHit)}),Mousetrap.bind("h",game.toggleHitBoxes),new Hammer(mainCanvas).on("press",function(e){e.preventDefault(),game.setMouseX(e.gesture.center.x),game.setMouseY(e.gesture.center.y)}).on("tap",function(e){game.setMouseX(e.gesture.center.x),game.setMouseY(e.gesture.center.y)}).on("pan",function(e){game.setMouseX(e.gesture.center.x),game.setMouseY(e.gesture.center.y),player.resetDirection(),player.startMovingIfPossible()}).on("doubletap",function(e){player.speedBoost()}),player.isMoving=!1,player.setDirection(270),$(".play").click(function(){$("#menu").hide(),mainCanvas.style.display="",game.start()}),mainCanvas.style.display="none",$("#main").show()},loaded=0,images={},(sources=["assets/cart-sprites.png","assets/sprite-characters.png","assets/skifree-objects.png","assets/token-sprites.png"]).each(function(src){var im=new Image;im.onload=finish,im.src=src,dContext.storeLoadedImage(src,im)}),this.exports=window},{"./lib/canvasRenderingContext2DExtensions":1,"./lib/extenders":2,"./lib/game":3,"./lib/infoBox":5,"./lib/isMobileDevice":6,"./lib/monster":7,"./lib/player":8,"./lib/plugins":9,"./lib/snowboarder":10,"./lib/sprite":11,"./lib/spriteArray":12,"./spriteInfo":14,"br-mousetrap":15,hammerjs:18}],14:[function(require,module,exports){var sprites;require("./lib/game");function treeHitsMonsterBehaviour(tree,monster){monster.deleteOnNextCycle()}function treeHitsPlayerBehaviour(tree,player){player.hasHitObstacle(tree)}require=this,(sprites={player:{$imageFile:"assets/cart-sprites.png",parts:{blank:[0,0,0,0],east:[0,210,120,99],esEast:[247,104,105,104],sEast:[140,104,79,104],south:[26,104,67,104],sWest:[260,0,79,104],wsWest:[127,0,105,104],west:[0,0,120,104],hit:[26,104,67,104],jumping:[26,104,67,104],somersault1:[26,104,67,104]},hitBoxes:{0:[5,10,62,90]},id:"player",hitBehaviour:{}},token:{$imageFile:"assets/token-sprites.png",collectible:!0,pointValues:[125,150,175,200,250,300,350,400,450,500],parts:{main:[0,0,25,26],frame2:[25,0,25,26],frame3:[50,0,25,26],frame4:[75,0,25,26]},hitBehavior:{}},smallTree:{$imageFile:"assets/skifree-objects.png",parts:{main:[0,28,30,34]},hitBoxes:{0:[0,18,30,34]},hitBehaviour:{}},tallTree:{$imageFile:"assets/skifree-objects.png",parts:{main:[95,66,32,64]},zIndexesOccupied:[0,1],hitBoxes:{0:[0,54,32,64],1:[0,10,32,54]},hitBehaviour:{}},thickSnow:{$imageFile:"assets/skifree-objects.png",parts:{main:[143,53,43,10]},hitBehaviour:{}},rock:{$imageFile:"assets/skifree-objects.png",parts:{main:[30,52,23,11]},hitBehaviour:{}},monster:{$imageFile:"assets/sprite-characters.png",parts:{sEast1:[64,112,26,43],sEast2:[90,112,32,43],sWest1:[64,158,26,43],sWest2:[90,158,32,43],eating1:[122,112,34,43],eating2:[156,112,31,43],eating3:[187,112,31,43],eating4:[219,112,25,43],eating5:[243,112,26,43]},hitBehaviour:{}},jump:{$imageFile:"assets/skifree-objects.png",parts:{main:[109,55,32,8]},hitBehaviour:{}},signStart:{$imageFile:"assets/skifree-objects.png",parts:{main:[260,103,42,27]},hitBehaviour:{}},snowboarder:{$imageFile:"assets/sprite-characters.png",parts:{sEast:[73,229,20,29],sWest:[95,228,26,30]},hitBehaviour:{}},emptyChairLift:{$imageFile:"assets/skifree-objects.png",parts:{main:[92,136,26,30]},zIndexesOccupied:[1]}}).monster.hitBehaviour.tree=function(monster){monster.deleteOnNextCycle()},sprites.smallTree.hitBehaviour.monster=treeHitsMonsterBehaviour,sprites.tallTree.hitBehaviour.monster=treeHitsMonsterBehaviour,sprites.smallTree.hitBehaviour.player=treeHitsPlayerBehaviour,sprites.tallTree.hitBehaviour.player=treeHitsPlayerBehaviour,sprites.rock.hitBehaviour.player=function(rock,player){player.hasHitObstacle(rock)},sprites.jump.hitBehaviour.player=function(jump,player){player.hasHitJump(jump)},sprites.snowboarder.hitBehaviour.player=function(snowboarder,player){player.hasHitObstacle(snowboarder)},sprites.token.hitBehaviour.player=function(player,token){console.log("hit token"),token.deleteOnNextCycle()},require.spriteInfo=sprites,void 0!==module&&(module.exports=this.spriteInfo)},{"./lib/game":3}],15:[function(require,module,exports){for(var _REVERSE_MAP,_reset_timer,_MAP={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",224:"meta"},_KEYCODE_MAP={106:"*",107:"+",109:"-",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},_SHIFT_MAP={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"},_SPECIAL_ALIASES={option:"alt",command:"meta",return:"enter",escape:"esc"},_callbacks={},_direct_map={},_sequence_levels={},_ignore_next_keyup=!1,_inside_sequence=!1,i=1;i<20;++i)_MAP[111+i]="f"+i;for(i=0;i<=9;++i)_MAP[i+96]=i;function _addEvent(object,type,callback){object.addEventListener?object.addEventListener(type,callback,!1):object.attachEvent("on"+type,callback)}function _characterFromEvent(e){return"keypress"==e.type?String.fromCharCode(e.which):_MAP[e.which]||_KEYCODE_MAP[e.which]||String.fromCharCode(e.which).toLowerCase()}function _resetSequences(do_not_reset){do_not_reset=do_not_reset||{};var key,active_sequences=!1;for(key in _sequence_levels)do_not_reset[key]?active_sequences=!0:_sequence_levels[key]=0;active_sequences||(_inside_sequence=!1)}function _getMatches(character,modifiers,e,remove,combination){var i,callback,modifiers1,modifiers2,matches=[],action=e.type;if(!_callbacks[character])return[];for("keyup"==action&&_isModifier(character)&&(modifiers=[character]),i=0;i<_callbacks[character].length;++i)(callback=_callbacks[character][i]).seq&&_sequence_levels[callback.seq]!=callback.level||action!=callback.action||("keypress"!=action||e.metaKey||e.ctrlKey)&&(modifiers1=modifiers,modifiers2=callback.modifiers,modifiers1.sort().join(",")!==modifiers2.sort().join(","))||(remove&&callback.combo==combination&&_callbacks[character].splice(i,1),matches.push(callback));return matches}function _fireCallback(callback,e){!1===callback(e)&&(e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.returnValue=!1,e.cancelBubble=!0)}function _handleCharacter(character,e){if(!Mousetrap.stopCallback(e,e.target||e.srcElement)){for(var callbacks=_getMatches(character,function(e){var modifiers=[];return e.shiftKey&&modifiers.push("shift"),e.altKey&&modifiers.push("alt"),e.ctrlKey&&modifiers.push("ctrl"),e.metaKey&&modifiers.push("meta"),modifiers}(e),e),do_not_reset={},processed_sequence_callback=!1,i=0;i<callbacks.length;++i)callbacks[i].seq?(processed_sequence_callback=!0,do_not_reset[callbacks[i].seq]=1,_fireCallback(callbacks[i].callback,e)):processed_sequence_callback||_inside_sequence||_fireCallback(callbacks[i].callback,e);e.type!=_inside_sequence||_isModifier(character)||_resetSequences(do_not_reset)}}function _handleKey(e){e.which="number"==typeof e.which?e.which:e.keyCode;var character=_characterFromEvent(e);character&&("keyup"==e.type&&_ignore_next_keyup==character?_ignore_next_keyup=!1:_handleCharacter(character,e))}function _isModifier(key){return"shift"==key||"ctrl"==key||"alt"==key||"meta"==key}function _pickBestAction(key,modifiers,action){return action="keypress"==(action=action||(function(){if(!_REVERSE_MAP)for(var key in _REVERSE_MAP={},_MAP)95<key&&key<112||_MAP.hasOwnProperty(key)&&(_REVERSE_MAP[_MAP[key]]=key);return _REVERSE_MAP}()[key]?"keydown":"keypress"))&&modifiers.length?"keydown":action}function _bindSequence(combo,keys,callback,action){_sequence_levels[combo]=0,action=action||_pickBestAction(keys[0],[]);function _increaseSequence(e){_inside_sequence=action,++_sequence_levels[combo],clearTimeout(_reset_timer),_reset_timer=setTimeout(_resetSequences,1e3)}function _callbackAndReset(e){_fireCallback(callback,e),"keyup"!==action&&(_ignore_next_keyup=_characterFromEvent(e)),setTimeout(_resetSequences,10)}for(var i=0;i<keys.length;++i)_bindSingle(keys[i],i<keys.length-1?_increaseSequence:_callbackAndReset,action,combo,i)}function _bindSingle(combination,callback,action,sequence_name,level){var i,key,keys,sequence=(combination=combination.replace(/\s+/g," ")).split(" "),modifiers=[];if(1<sequence.length)_bindSequence(combination,sequence,callback,action);else{for(keys="+"===combination?["+"]:combination.split("+"),i=0;i<keys.length;++i)key=keys[i],_SPECIAL_ALIASES[key]&&(key=_SPECIAL_ALIASES[key]),action&&"keypress"!=action&&_SHIFT_MAP[key]&&(key=_SHIFT_MAP[key],modifiers.push("shift")),_isModifier(key)&&modifiers.push(key);action=_pickBestAction(key,modifiers,action),_callbacks[key]||(_callbacks[key]=[]),_getMatches(key,modifiers,{type:action},!sequence_name,combination),_callbacks[key][sequence_name?"unshift":"push"]({callback:callback,modifiers:modifiers,action:action,seq:sequence_name,level:level,combo:combination})}}_addEvent(document,"keypress",_handleKey),_addEvent(document,"keydown",_handleKey),_addEvent(document,"keyup",_handleKey);var Mousetrap={bind:function(keys,callback,action){return function(combinations,callback,action){for(var i=0;i<combinations.length;++i)_bindSingle(combinations[i],callback,action)}(keys instanceof Array?keys:[keys],callback,action),_direct_map[keys+":"+action]=callback,this},unbind:function(keys,action){return _direct_map[keys+":"+action]&&(delete _direct_map[keys+":"+action],this.bind(keys,function(){},action)),this},trigger:function(keys,action){return _direct_map[keys+":"+action](),this},reset:function(){return _callbacks={},_direct_map={},this},stopCallback:function(e,element){return!(-1<(" "+element.className+" ").indexOf(" mousetrap "))&&("INPUT"==element.tagName||"SELECT"==element.tagName||"TEXTAREA"==element.tagName||element.contentEditable&&"true"==element.contentEditable)}};window.Mousetrap=Mousetrap,"function"==typeof define&&define.amd&&define("mousetrap",function(){return Mousetrap}),"object"==typeof module&&module.exports&&(module.exports=Mousetrap)},{}],16:[function(require,module,exports){!function(global){!function(){!function(){var root=this,EventEmitter=require("events").EventEmitter,_=require("underscore"),intervalParser=/([0-9\.]+)(ms|s|m|h)?/,root=global||window;function parseEvent(e){e=intervalParser.exec(e);if(!e)throw new Error("I don't understand that particular interval");var intervalAmount=+e[1],e=e[2]||"ms";if("s"===e)intervalAmount*=1e3;else if("m"===e)intervalAmount=1e3*intervalAmount*60;else if("h"===e)intervalAmount=1e3*intervalAmount*60*60;else if(e&&"ms"!==e)throw new Error("You can only specify intervals of ms, s, m, or h");if(intervalAmount<10||intervalAmount%10!=0)throw new Error("You can only specify 10s of milliseconds, trust me on this one");return{amount:intervalAmount,type:e}}function EventedLoop(){this.intervalId=void 0,this.intervalLength=void 0,this.intervalsToEmit={},this.currentTick=1,this.maxTicks=0,this.listeningForFocus=!1;var determineIntervalLength=function(){var potentialIntervalLength=function(intervals){for(var sumOfModuli=1,interval=_.min(intervals);0!==sumOfModuli;)0!==(sumOfModuli=_.reduce(intervals,function(memo,i){return memo+i%interval},0))&&(interval-=10);return interval}(_.keys(this.intervalsToEmit)),changed=!1;return this.intervalLength?potentialIntervalLength!==this.intervalLength&&(this.intervalLength=potentialIntervalLength,changed=!0):this.intervalLength=potentialIntervalLength,this.maxTicks=_.max(_.map(_.keys(this.intervalsToEmit),function(a){return+a}))/this.intervalLength,changed}.bind(this);this.on("newListener",function(e){var intervalAmount;"removeListener"!==e&&"newListener"!==e&&(intervalAmount=parseEvent(e).amount,this.intervalsToEmit[+intervalAmount]=_.union(this.intervalsToEmit[+intervalAmount]||[],[e]),determineIntervalLength()&&this.isStarted()&&this.stop().start())}),this.on("removeListener",function(e){var intervalAmount;0<EventEmitter.listenerCount(this,e)||(intervalAmount=parseEvent(e).amount,e=this.intervalsToEmit[+intervalAmount].removeOne(e),0===this.intervalsToEmit[+intervalAmount].length&&delete this.intervalsToEmit[+intervalAmount],console.log("Determining interval length after removal of",e),determineIntervalLength(),determineIntervalLength()&&this.isStarted()&&this.stop().start())})}void 0===Function.prototype.inherits&&(Function.prototype.inherits=function(parent){this.prototype=Object.create(parent.prototype)}),void 0===Array.prototype.removeOne&&(Array.prototype.removeOne=function(){for(var what,a=arguments,L=a.length;L&&this.length;)if(what=a[--L],-1!==(what=this.indexOf(what)))return this.splice(what,1)}),EventedLoop.inherits(EventEmitter),EventedLoop.prototype.tick=function(){var milliseconds=this.currentTick*this.intervalLength;return _.each(this.intervalsToEmit,function(events,key){milliseconds%key==0&&_.each(events,function(e){this.emit(e,e,key)}.bind(this))}.bind(this)),this.currentTick+=1,this.currentTick>this.maxTicks&&(this.currentTick=1),this},EventedLoop.prototype.start=function(){if(this.intervalLength)return this.intervalId?console.log("No need to start the loop again, it's already started."):(this.intervalId=setInterval(this.tick.bind(this),this.intervalLength),root&&!this.listeningForFocus&&root.addEventListener&&(root.addEventListener("focus",function(){this.start()}.bind(this)),root.addEventListener("blur",function(){this.stop()}.bind(this)),this.listeningForFocus=!0),this);throw new Error("You haven't specified any interval callbacks. Use EventedLoop.on('500ms', function () { ... }) to do so, and then you can start")},EventedLoop.prototype.stop=function(){return clearInterval(this.intervalId),this.intervalId=void 0,this},EventedLoop.prototype.isStarted=function(){return!!this.intervalId},EventedLoop.prototype.every=EventedLoop.prototype.on,void 0!==exports&&((exports=void 0!==module&&module.exports?module.exports=EventedLoop:exports).EventedLoop=EventedLoop),"undefined"!=typeof window&&(window.EventedLoop=EventedLoop)}.call(this)}.call(this)}.call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{events:17,underscore:19}],17:[function(require,module,exports){"use strict";var R="object"==typeof Reflect?Reflect:null,ReflectApply=R&&"function"==typeof R.apply?R.apply:function(target,receiver,args){return Function.prototype.apply.call(target,receiver,args)};var ReflectOwnKeys=R&&"function"==typeof R.ownKeys?R.ownKeys:Object.getOwnPropertySymbols?function(target){return Object.getOwnPropertyNames(target).concat(Object.getOwnPropertySymbols(target))}:function(target){return Object.getOwnPropertyNames(target)},NumberIsNaN=Number.isNaN||function(value){return value!=value};function EventEmitter(){EventEmitter.init.call(this)}module.exports=EventEmitter,module.exports.once=function(emitter,name){return new Promise(function(resolve,reject){function errorListener(err){emitter.removeListener(name,resolver),reject(err)}function resolver(){"function"==typeof emitter.removeListener&&emitter.removeListener("error",errorListener),resolve([].slice.call(arguments))}eventTargetAgnosticAddListener(emitter,name,resolver,{once:!0}),"error"!==name&&function(emitter,handler,flags){"function"==typeof emitter.on&&eventTargetAgnosticAddListener(emitter,"error",handler,flags)}(emitter,errorListener,{once:!0})})},(EventEmitter.EventEmitter=EventEmitter).prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var defaultMaxListeners=10;function checkListener(listener){if("function"!=typeof listener)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof listener)}function _getMaxListeners(that){return void 0===that._maxListeners?EventEmitter.defaultMaxListeners:that._maxListeners}function _addListener(target,type,listener,prepend){var events,existing;return checkListener(listener),void 0===(events=target._events)?(events=target._events=Object.create(null),target._eventsCount=0):(void 0!==events.newListener&&(target.emit("newListener",type,listener.listener||listener),events=target._events),existing=events[type]),void 0===existing?(existing=events[type]=listener,++target._eventsCount):("function"==typeof existing?existing=events[type]=prepend?[listener,existing]:[existing,listener]:prepend?existing.unshift(listener):existing.push(listener),0<(events=_getMaxListeners(target))&&existing.length>events&&!existing.warned&&(existing.warned=!0,(prepend=new Error("Possible EventEmitter memory leak detected. "+existing.length+" "+String(type)+" listeners added. Use emitter.setMaxListeners() to increase limit")).name="MaxListenersExceededWarning",prepend.emitter=target,prepend.type=type,prepend.count=existing.length,listener=prepend,console&&console.warn&&console.warn(listener))),target}function _onceWrap(target,type,listener){target={fired:!1,wrapFn:void 0,target:target,type:type,listener:listener},type=function(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}.bind(target);return type.listener=listener,target.wrapFn=type}function _listeners(target,type,unwrap){target=target._events;if(void 0===target)return[];target=target[type];{if(void 0===target)return[];if("function"==typeof target)return unwrap?[target.listener||target]:[target];if(unwrap){for(var arr=target,ret=new Array(arr.length),i=0;i<ret.length;++i)ret[i]=arr[i].listener||arr[i];return ret}return arrayClone(target,target.length)}}function listenerCount(type){var events=this._events;if(void 0!==events){events=events[type];if("function"==typeof events)return 1;if(void 0!==events)return events.length}return 0}function arrayClone(arr,n){for(var copy=new Array(n),i=0;i<n;++i)copy[i]=arr[i];return copy}function eventTargetAgnosticAddListener(emitter,name,listener,flags){if("function"==typeof emitter.on)flags.once?emitter.once(name,listener):emitter.on(name,listener);else{if("function"!=typeof emitter.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof emitter);emitter.addEventListener(name,function wrapListener(arg){flags.once&&emitter.removeEventListener(name,wrapListener),listener(arg)})}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return defaultMaxListeners},set:function(arg){if("number"!=typeof arg||arg<0||NumberIsNaN(arg))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+arg+".");defaultMaxListeners=arg}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function(n){if("number"!=typeof n||n<0||NumberIsNaN(n))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+n+".");return this._maxListeners=n,this},EventEmitter.prototype.getMaxListeners=function(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function(type){for(var args=[],i=1;i<arguments.length;i++)args.push(arguments[i]);var doError="error"===type,events=this._events;if(void 0!==events)doError=doError&&void 0===events.error;else if(!doError)return!1;if(doError){if((er=0<args.length?args[0]:er)instanceof Error)throw er;doError=new Error("Unhandled error."+(er?" ("+er.message+")":""));throw doError.context=er,doError}var er=events[type];if(void 0===er)return!1;if("function"==typeof er)ReflectApply(er,this,args);else for(var len=er.length,listeners=arrayClone(er,len),i=0;i<len;++i)ReflectApply(listeners[i],this,args);return!0},EventEmitter.prototype.on=EventEmitter.prototype.addListener=function(type,listener){return _addListener(this,type,listener,!1)},EventEmitter.prototype.prependListener=function(type,listener){return _addListener(this,type,listener,!0)},EventEmitter.prototype.once=function(type,listener){return checkListener(listener),this.on(type,_onceWrap(this,type,listener)),this},EventEmitter.prototype.prependOnceListener=function(type,listener){return checkListener(listener),this.prependListener(type,_onceWrap(this,type,listener)),this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener=function(type,listener){var list,events,position,i,originalListener;if(checkListener(listener),void 0===(events=this._events))return this;if(void 0===(list=events[type]))return this;if(list===listener||list.listener===listener)0==--this._eventsCount?this._events=Object.create(null):(delete events[type],events.removeListener&&this.emit("removeListener",type,list.listener||listener));else if("function"!=typeof list){for(position=-1,i=list.length-1;0<=i;i--)if(list[i]===listener||list[i].listener===listener){originalListener=list[i].listener,position=i;break}if(position<0)return this;0===position?list.shift():function(list,index){for(;index+1<list.length;index++)list[index]=list[index+1];list.pop()}(list,position),1===list.length&&(events[type]=list[0]),void 0!==events.removeListener&&this.emit("removeListener",type,originalListener||listener)}return this},EventEmitter.prototype.removeAllListeners=function(type){var listeners,events=this._events;if(void 0===events)return this;if(void 0===events.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==events[type]&&(0==--this._eventsCount?this._events=Object.create(null):delete events[type]),this;if(0===arguments.length){for(var key,keys=Object.keys(events),i=0;i<keys.length;++i)"removeListener"!==(key=keys[i])&&this.removeAllListeners(key);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(listeners=events[type]))this.removeListener(type,listeners);else if(void 0!==listeners)for(i=listeners.length-1;0<=i;i--)this.removeListener(type,listeners[i]);return this},EventEmitter.prototype.listeners=function(type){return _listeners(this,type,!0)},EventEmitter.prototype.rawListeners=function(type){return _listeners(this,type,!1)},EventEmitter.listenerCount=function(emitter,type){return"function"==typeof emitter.listenerCount?emitter.listenerCount(type):listenerCount.call(emitter,type)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function(){return 0<this._eventsCount?ReflectOwnKeys(this._events):[]}},{}],18:[function(require,module,exports){!function(window,document,undefined){"use strict";function ifUndefined(val1,val2){return val1===undefined?val2:val1}var VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"],TEST_ELEMENT=document.createElement("div"),round=Math.round,abs=Math.abs,now=Date.now;function prefixed(obj,property){for(var prefix,camelProp=property[0].toUpperCase()+property.slice(1),i=0;i<VENDOR_PREFIXES.length;){if((prefix=(prefix=VENDOR_PREFIXES[i])?prefix+camelProp:property)in obj)return prefix;i++}return undefined}var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined,TOUCH_ACTION_MAP=function(){if(!NATIVE_TOUCH_ACTION)return!1;var touchMap={},cssSupports=window.CSS&&window.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(val){return touchMap[val]=!cssSupports||window.CSS.supports("touch-action",val)}),touchMap}(),SUPPORT_TOUCH="ontouchstart"in window,SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined,SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),INPUT_START=1,INPUT_END=4,INPUT_CANCEL=8,PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"],assign$1="function"!=typeof Object.assign?function(target){if(target===undefined||null===target)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(target),index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&null!==source)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey])}return output}:Object.assign,_uniqueId=1;function each(obj,iterator,context){var i=void 0;if(obj)if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined)for(i=0;i<obj.length;)iterator.call(context,obj[i],i,obj),i++;else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function invokeArrayArg(arg,fn,context){return Array.isArray(arg)&&(each(arg,context[fn],context),1)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);for(var i=0;i<src.length;){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}var createClass=function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor};function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);return desc===undefined?null===(object=Object.getPrototypeOf(object))?undefined:get(object,property,receiver):"value"in desc?desc.value:(object=desc.get)===undefined?undefined:object.call(receiver)}function inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function possibleConstructorReturn(self,call){if(self)return!call||"object"!=typeof call&&"function"!=typeof call?self:call;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}var slicedToArray=function(arr,i){if(Array.isArray(arr))return arr;if(Symbol.iterator in Object(arr))return function(arr,i){var _arr=[],_n=!0,_d=!1,_e=undefined;try{for(var _s,_i=arr[Symbol.iterator]();!(_n=(_s=_i.next()).done)&&(_arr.push(_s.value),!i||_arr.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{!_n&&_i.return&&_i.return()}finally{if(_d)throw _e}}return _arr}(arr,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")};function boolOrFn(val,args){return"function"===(void 0===val?"undefined":_typeof(val))?val.apply(args&&args[0]||undefined,args):val}function getRecognizerByNameIfManager(otherRecognizer,recognizer){recognizer=recognizer.manager;return recognizer?recognizer.get(otherRecognizer):otherRecognizer}function stateStr(state){return 16&state?"cancel":8&state?"end":4&state?"move":2&state?"start":""}var Recognizer=function(){function Recognizer(options){classCallCheck(this,Recognizer),this.options=assign$1({},this.defaults,options||{}),this.id=_uniqueId++,this.manager=null,this.options.enable=ifUndefined(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}return createClass(Recognizer,[{key:"set",value:function(options){return assign$1(this.options,options),this.manager&&this.manager.touchAction.update(),this}},{key:"recognizeWith",value:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return simultaneous[(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this)).id]||(simultaneous[otherRecognizer.id]=otherRecognizer).recognizeWith(this),this}},{key:"dropRecognizeWith",value:function(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)||(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id]),this}},{key:"requireFailure",value:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return-1===inArray(requireFail,otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this))&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this}},{key:"dropRequireFailure",value:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);otherRecognizer=inArray(this.requireFail,otherRecognizer);return-1<otherRecognizer&&this.requireFail.splice(otherRecognizer,1),this}},{key:"hasRequireFailures",value:function(){return 0<this.requireFail.length}},{key:"canRecognizeWith",value:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]}},{key:"emit",value:function(input){var self=this,state=this.state;function emit(event){self.manager.emit(event,input)}state<8&&emit(self.options.event+stateStr(state)),emit(self.options.event),input.additionalEvent&&emit(input.additionalEvent),8<=state&&emit(self.options.event+stateStr(state))}},{key:"tryEmit",value:function(input){if(this.canEmit())return this.emit(input);this.state=32}},{key:"canEmit",value:function(){for(var i=0;i<this.requireFail.length;){if(!(33&this.requireFail[i].state))return!1;i++}return!0}},{key:"recognize",value:function(inputData){inputData=assign$1({},inputData);if(!boolOrFn(this.options.enable,[this,inputData]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(inputData),30&this.state&&this.tryEmit(inputData)}},{key:"process",value:function(inputData){}},{key:"getTouchAction",value:function(){}},{key:"reset",value:function(){}}]),Recognizer}(),AttrRecognizer=(Recognizer.prototype.defaults={},function(){function AttrRecognizer(){return classCallCheck(this,AttrRecognizer),possibleConstructorReturn(this,(AttrRecognizer.__proto__||Object.getPrototypeOf(AttrRecognizer)).apply(this,arguments))}return inherits(AttrRecognizer,Recognizer),createClass(AttrRecognizer,[{key:"attrTest",value:function(input){var optionPointers=this.options.pointers;return 0===optionPointers||input.pointers.length===optionPointers}},{key:"process",value:function(input){var state=this.state,eventType=input.eventType,isRecognized=6&state,input=this.attrTest(input);return isRecognized&&(eventType&INPUT_CANCEL||!input)?16|state:isRecognized||input?eventType&INPUT_END?8|state:2&state?4|state:2:32}}]),AttrRecognizer}()),TEST_ELEMENT=(AttrRecognizer.prototype.defaults={pointers:1},function(){function RotateRecognizer(){return classCallCheck(this,RotateRecognizer),possibleConstructorReturn(this,(RotateRecognizer.__proto__||Object.getPrototypeOf(RotateRecognizer)).apply(this,arguments))}return inherits(RotateRecognizer,AttrRecognizer),createClass(RotateRecognizer,[{key:"getTouchAction",value:function(){return["none"]}},{key:"attrTest",value:function(input){return get(RotateRecognizer.prototype.__proto__||Object.getPrototypeOf(RotateRecognizer.prototype),"attrTest",this).call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||2&this.state)}}]),RotateRecognizer}()),PinchRecognizer=(TEST_ELEMENT.prototype.defaults={event:"rotate",threshold:0,pointers:2},function(){function PinchRecognizer(){return classCallCheck(this,PinchRecognizer),possibleConstructorReturn(this,(PinchRecognizer.__proto__||Object.getPrototypeOf(PinchRecognizer)).apply(this,arguments))}return inherits(PinchRecognizer,AttrRecognizer),createClass(PinchRecognizer,[{key:"getTouchAction",value:function(){return["none"]}},{key:"attrTest",value:function(input){return get(PinchRecognizer.prototype.__proto__||Object.getPrototypeOf(PinchRecognizer.prototype),"attrTest",this).call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||2&this.state)}},{key:"emit",value:function(input){var inOut;1!==input.scale&&(inOut=input.scale<1?"in":"out",input.additionalEvent=this.options.event+inOut),get(PinchRecognizer.prototype.__proto__||Object.getPrototypeOf(PinchRecognizer.prototype),"emit",this).call(this,input)}}]),PinchRecognizer}());function directionStr(direction){return 16===direction?"down":8===direction?"up":2===direction?"left":4===direction?"right":""}PinchRecognizer.prototype.defaults={event:"pinch",threshold:0,pointers:2};var PanRecognizer=function(){function PanRecognizer(){classCallCheck(this,PanRecognizer);var _this=possibleConstructorReturn(this,(PanRecognizer.__proto__||Object.getPrototypeOf(PanRecognizer)).apply(this,arguments));return _this.pX=null,_this.pY=null,_this}return inherits(PanRecognizer,AttrRecognizer),createClass(PanRecognizer,[{key:"getTouchAction",value:function(){var direction=this.options.direction,actions=[];return 6&direction&&actions.push("pan-y"),24&direction&&actions.push("pan-x"),actions}},{key:"directionTest",value:function(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(distance=6&options.direction?(direction=0===x?1:x<0?2:4,hasMoved=x!==this.pX,Math.abs(input.deltaX)):(direction=0===y?1:y<0?8:16,hasMoved=y!==this.pY,Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction}},{key:"attrTest",value:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(2&this.state||!(2&this.state)&&this.directionTest(input))}},{key:"emit",value:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&(input.additionalEvent=this.options.event+direction),get(PanRecognizer.prototype.__proto__||Object.getPrototypeOf(PanRecognizer.prototype),"emit",this).call(this,input)}}]),PanRecognizer}(),SwipeRecognizer=(PanRecognizer.prototype.defaults={event:"pan",threshold:10,pointers:1,direction:30},function(){function SwipeRecognizer(){return classCallCheck(this,SwipeRecognizer),possibleConstructorReturn(this,(SwipeRecognizer.__proto__||Object.getPrototypeOf(SwipeRecognizer)).apply(this,arguments))}return inherits(SwipeRecognizer,AttrRecognizer),createClass(SwipeRecognizer,[{key:"getTouchAction",value:function(){return PanRecognizer.prototype.getTouchAction.call(this)}},{key:"attrTest",value:function(input){var direction=this.options.direction,velocity=void 0;return 30&direction?velocity=input.overallVelocity:6&direction?velocity=input.overallVelocityX:24&direction&&(velocity=input.overallVelocityY),get(SwipeRecognizer.prototype.__proto__||Object.getPrototypeOf(SwipeRecognizer.prototype),"attrTest",this).call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers===this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END}},{key:"emit",value:function(input){var direction=directionStr(input.offsetDirection);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)}}]),SwipeRecognizer}());function bindFn(fn,context){return function(){return fn.apply(context,arguments)}}function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function getDistance(p1,p2,props){var x=p2[(props=props||PROPS_XY)[0]]-p1[props[0]],p2=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+p2*p2)}SwipeRecognizer.prototype.defaults={event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1};var TapRecognizer=function(){function TapRecognizer(){classCallCheck(this,TapRecognizer);var _this=possibleConstructorReturn(this,(TapRecognizer.__proto__||Object.getPrototypeOf(TapRecognizer)).apply(this,arguments));return _this.pTime=!1,_this.pCenter=!1,_this._timer=null,_this._input=null,_this.count=0,_this}return inherits(TapRecognizer,Recognizer),createClass(TapRecognizer,[{key:"getTouchAction",value:function(){return["manipulation"]}},{key:"process",value:function(input){var _this2=this,options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;if(this.reset(),input.eventType&INPUT_START&&0===this.count)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!==INPUT_END)return this.failTimeout();validMovement=!this.pTime||input.timeStamp-this.pTime<options.interval,validTouchTime=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;if(this.pTime=input.timeStamp,this.pCenter=input.center,validTouchTime&&validMovement?this.count+=1:this.count=1,this._input=input,0==this.count%options.taps)return this.hasRequireFailures()?(this._timer=setTimeoutContext(function(){_this2.state=8,_this2.tryEmit()},options.interval,this),2):8}return 32}},{key:"failTimeout",value:function(){var _this3=this;return this._timer=setTimeoutContext(function(){_this3.state=32},this.options.interval,this),32}},{key:"reset",value:function(){clearTimeout(this._timer)}},{key:"emit",value:function(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}]),TapRecognizer}(),PressRecognizer=(TapRecognizer.prototype.defaults={event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},function(){function PressRecognizer(){classCallCheck(this,PressRecognizer);var _this=possibleConstructorReturn(this,(PressRecognizer.__proto__||Object.getPrototypeOf(PressRecognizer)).apply(this,arguments));return _this._timer=null,_this._input=null,_this}return inherits(PressRecognizer,Recognizer),createClass(PressRecognizer,[{key:"getTouchAction",value:function(){return["auto"]}},{key:"process",value:function(input){var _this2=this,options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;if(this._input=input,!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext(function(){_this2.state=8,_this2.tryEmit()},options.time,this);else if(input.eventType&INPUT_END)return 8;return 32}},{key:"reset",value:function(){clearTimeout(this._timer)}},{key:"emit",value:function(input){8===this.state&&(input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input)))}}]),PressRecognizer}());function inStr(str,find){return-1<str.indexOf(find)}PressRecognizer.prototype.defaults={event:"press",pointers:1,time:251,threshold:9};var TouchAction=function(){function TouchAction(manager,value){classCallCheck(this,TouchAction),this.manager=manager,this.set(value)}return createClass(TouchAction,[{key:"set",value:function(value){"compute"===value&&(value=this.compute()),NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()}},{key:"update",value:function(){this.set(this.manager.options.touchAction)}},{key:"compute",value:function(){var actions=[];return each(this.manager.recognizers,function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))}),function(actions){if(inStr(actions,"none"))return"none";var hasPanX=inStr(actions,"pan-x"),hasPanY=inStr(actions,"pan-y");return hasPanX&&hasPanY?"none":hasPanX||hasPanY?hasPanX?"pan-x":"pan-y":inStr(actions,"manipulation")?"manipulation":"auto"}(actions.join(" "))}},{key:"preventDefaults",value:function(input){var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented)srcEvent.preventDefault();else{var actions=this.actions,hasNone=inStr(actions,"none")&&!TOUCH_ACTION_MAP.none,hasPanY=inStr(actions,"pan-y")&&!TOUCH_ACTION_MAP["pan-y"],actions=inStr(actions,"pan-x")&&!TOUCH_ACTION_MAP["pan-x"];if(hasNone){var isTapPointer=1===input.pointers.length,isTapMovement=input.distance<2,input=input.deltaTime<250;if(isTapPointer&&isTapMovement&&input)return}if(!actions||!hasPanY)return hasNone||hasPanY&&6&direction||actions&&24&direction?this.preventSrc(srcEvent):void 0}}},{key:"preventSrc",value:function(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()}}]),TouchAction}();function hasParent(node,parent){for(;node;){if(node===parent)return!0;node=node.parentNode}return!1}function getCenter(pointers){var pointersLength=pointers.length;if(1===pointersLength)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};for(var x=0,y=0,i=0;i<pointersLength;)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function simpleCloneInputData(input){for(var pointers=[],i=0;i<input.pointers.length;)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getAngle(p1,p2,props){var x=p2[(props=props||PROPS_XY)[0]]-p1[props[0]],p2=p2[props[1]]-p1[props[1]];return 180*Math.atan2(p2,x)/Math.PI}function getDirection(x,y){return x===y?1:abs(x)>=abs(y)?x<0?2:4:y<0?8:16}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function computeInputData(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length,pointersLength=(session.firstInput||(session.firstInput=simpleCloneInputData(input)),1<pointersLength&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):1===pointersLength&&(session.firstMultiple=!1),session.firstInput),firstMultiple=session.firstMultiple,offsetCenter=(firstMultiple||pointersLength).center,center=input.center=getCenter(pointers),pointersLength=(input.timeStamp=now(),input.deltaTime=input.timeStamp-pointersLength.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),!function(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};input.eventType!==INPUT_START&&prevInput.eventType!==INPUT_END||(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y}),input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY),getVelocity(input.deltaTime,input.deltaX,input.deltaY)),center=(input.overallVelocityX=pointersLength.x,input.overallVelocityY=pointersLength.y,input.overallVelocity=abs(pointersLength.x)>abs(pointersLength.y)?pointersLength.x:pointersLength.y,input.scale=firstMultiple?(offsetCenter=firstMultiple.pointers,getDistance(pointers[0],pointers[1],PROPS_CLIENT_XY)/getDistance(offsetCenter[0],offsetCenter[1],PROPS_CLIENT_XY)):1,input.rotation=firstMultiple?function(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}(firstMultiple.pointers,pointers):0,input.maxPointers=!session.prevInput||input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers,!function(session,input){var deltaY,v,last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp,velocity=void 0,velocityX=void 0,velocityY=void 0,direction=void 0;input.eventType!==INPUT_CANCEL&&(25<deltaTime||last.velocity===undefined)?(velocityX=(v=getVelocity(deltaTime,deltaTime=input.deltaX-last.deltaX,deltaY=input.deltaY-last.deltaY)).x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaTime,deltaY),session.lastInterval=input):(velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction),input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}(session,input),manager.element);hasParent(input.srcEvent.target,center)&&(center=input.srcEvent.target),input.target=center}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen==0,pointersLen=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen==0;input.isFirst=!!isFirst,input.isFinal=!!pointersLen,isFirst&&(manager.session={}),input.eventType=eventType,computeInputData(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function splitStr(str){return str.trim().split(/\s+/g)}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,!1)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,!1)})}function getWindowForElement(element){element=element.ownerDocument||element;return element.defaultView||element.parentWindow||window}var Input=function(){function Input(manager,callback){classCallCheck(this,Input);var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.init()}return createClass(Input,[{key:"handler",value:function(){}},{key:"init",value:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}},{key:"destroy",value:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}}]),Input}(),POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:2,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:"touch",3:"pen",4:"mouse",5:"kinect"},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel",PointerEventInput=(window.MSPointerEvent&&!window.PointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"),function(){function PointerEventInput(){classCallCheck(this,PointerEventInput);var _this=possibleConstructorReturn(this,(PointerEventInput.__proto__||Object.getPrototypeOf(PointerEventInput)).apply(this,arguments));return _this.evEl=POINTER_ELEMENT_EVENTS,_this.evWin=POINTER_WINDOW_EVENTS,_this.store=_this.manager.session.pointerEvents=[],_this}return inherits(PointerEventInput,Input),createClass(PointerEventInput,[{key:"handler",value:function(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventTypeNormalized=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch="touch"===pointerType,storeIndex=inArray(store,ev.pointerId,"pointerId");eventTypeNormalized&INPUT_START&&(0===ev.button||isTouch)?storeIndex<0&&(store.push(ev),storeIndex=store.length-1):eventTypeNormalized&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0),storeIndex<0||(store[storeIndex]=ev,this.callback(this.manager,eventTypeNormalized,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1))}}]),PointerEventInput}());function toArray$1(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){for(var results=[],values=[],i=0;i<src.length;){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++}return results=sort?key?results.sort(function(a,b){return a[key]>b[key]}):results.sort():results}var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:2,touchend:INPUT_END,touchcancel:INPUT_CANCEL},TouchInput=function(){function TouchInput(){classCallCheck(this,TouchInput),TouchInput.prototype.evTarget="touchstart touchmove touchend touchcancel",TouchInput.prototype.targetIds={};var _this=possibleConstructorReturn(this,(TouchInput.__proto__||Object.getPrototypeOf(TouchInput)).apply(this,arguments));return _this.evTarget="touchstart touchmove touchend touchcancel",_this.targetIds={},_this}return inherits(TouchInput,Input),createClass(TouchInput,[{key:"handler",value:function(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=function(ev,type){var allTouches=toArray$1(ev.touches),targetIds=this.targetIds;if(type&(2|INPUT_START)&&1===allTouches.length)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i=void 0,targetTouches=void 0,changedTouches=toArray$1(ev.changedTouches),changedTargetTouches=[],target=this.target;if(targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)}),type===INPUT_START)for(i=0;i<targetTouches.length;)targetIds[targetTouches[i].identifier]=!0,i++;i=0;for(;i<changedTouches.length;)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier],i++;if(changedTargetTouches.length)return[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]}.call(this,ev,type);touches&&this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev})}}]),TouchInput}();var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:2,mouseup:INPUT_END},MouseInput=function(){function MouseInput(){classCallCheck(this,MouseInput);var _this=possibleConstructorReturn(this,(MouseInput.__proto__||Object.getPrototypeOf(MouseInput)).apply(this,arguments));return _this.evEl="mousedown",_this.evWin="mousemove mouseup",_this.pressed=!1,_this}return inherits(MouseInput,Input),createClass(MouseInput,[{key:"handler",value:function(ev){var eventType=MOUSE_INPUT_MAP[ev.type];eventType&INPUT_START&&0===ev.button&&(this.pressed=!0),2&eventType&&1!==ev.which&&(eventType=INPUT_END),this.pressed&&(eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:"mouse",srcEvent:ev}))}}]),MouseInput}(),DEDUP_TIMEOUT=2500,TouchMouseInput=function(){function TouchMouseInput(){classCallCheck(this,TouchMouseInput);var _this=possibleConstructorReturn(this,(TouchMouseInput.__proto__||Object.getPrototypeOf(TouchMouseInput)).apply(this,arguments)),handler=bindFn(_this.handler,_this);return _this.touch=new TouchInput(_this.manager,handler),_this.mouse=new MouseInput(_this.manager,handler),_this.primaryTouch=null,_this.lastTouches=[],_this}return inherits(TouchMouseInput,Input),createClass(TouchMouseInput,[{key:"handler",value:function(manager,inputEvent,inputData){var isTouch="touch"===inputData.pointerType,isMouse="mouse"===inputData.pointerType;if(!(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)){if(isTouch)!function(eventType,eventData){eventType&INPUT_START?(this.primaryTouch=eventData.changedPointers[0].identifier,setLastTouch.call(this,eventData)):eventType&(INPUT_END|INPUT_CANCEL)&&setLastTouch.call(this,eventData)}.call(this,inputEvent,inputData);else if(isMouse&&function(eventData){for(var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i],dx=Math.abs(x-t.x),t=Math.abs(y-t.y);if(dx<=25&&t<=25)return!0}return!1}.call(this,inputData))return;this.callback(manager,inputEvent,inputData)}}},{key:"destroy",value:function(){this.touch.destroy(),this.mouse.destroy()}}]),TouchMouseInput}();function setLastTouch(eventData){var lastTouch,lts,_this2=this,eventData=slicedToArray(eventData.changedPointers,1)[0];eventData.identifier===this.primaryTouch&&(lastTouch={x:eventData.clientX,y:eventData.clientY},_this2.lastTouches.push(lastTouch),lts=_this2.lastTouches,setTimeout(function(){var i=lts.indexOf(lastTouch);-1<i&&lts.splice(i,1)},DEDUP_TIMEOUT))}var Manager=function(){function Manager(element,options){var _this=this;classCallCheck(this,Manager),this.options=assign$1({},Hammer.defaults,options||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=new((options=this).options.inputClass||(SUPPORT_POINTER_EVENTS?PointerEventInput:SUPPORT_ONLY_TOUCH?TouchInput:SUPPORT_TOUCH?TouchMouseInput:MouseInput))(options,inputHandler),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(this.options.recognizers,function(item){var recognizer=_this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3])},this)}return createClass(Manager,[{key:"set",value:function(options){return assign$1(this.options,options),options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this}},{key:"stop",value:function(force){this.session.stopped=force?2:1}},{key:"recognize",value:function(inputData){var session=this.session;if(!session.stopped){this.touchAction.preventDefaults(inputData);for(var recognizer=void 0,recognizers=this.recognizers,curRecognizer=session.curRecognizer,i=((!curRecognizer||8&curRecognizer.state)&&(curRecognizer=session.curRecognizer=null),0);i<recognizers.length;)recognizer=recognizers[i],2===session.stopped||curRecognizer&&recognizer!==curRecognizer&&!recognizer.canRecognizeWith(curRecognizer)?recognizer.reset():recognizer.recognize(inputData),!curRecognizer&&14&recognizer.state&&(curRecognizer=session.curRecognizer=recognizer),i++}}},{key:"get",value:function(recognizer){if(recognizer instanceof Recognizer)return recognizer;for(var recognizers=this.recognizers,i=0;i<recognizers.length;i++)if(recognizers[i].options.event===recognizer)return recognizers[i];return null}},{key:"add",value:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),(recognizer.manager=this).touchAction.update(),recognizer}},{key:"remove",value:function(recognizer){return invokeArrayArg(recognizer,"remove",this)||(recognizer=this.get(recognizer))&&-1!==(recognizer=inArray(recognizers=this.recognizers,recognizer))&&(recognizers.splice(recognizer,1),this.touchAction.update()),this;var recognizers}},{key:"on",value:function(events,handler){var handlers;if(events!==undefined&&handler!==undefined)return handlers=this.handlers,each(splitStr(events),function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)}),this}},{key:"off",value:function(events,handler){var handlers;if(events!==undefined)return handlers=this.handlers,each(splitStr(events),function(event){handler?handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]}),this}},{key:"emit",value:function(event,data){this.options.domEvents&&!function(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),(gestureEvent.gesture=data).target.dispatchEvent(gestureEvent)}(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(handlers&&handlers.length){data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0;i<handlers.length;)handlers[i](data),i++}}},{key:"destroy",value:function(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}}]),Manager}();function toggleCssProps(manager,add){var prop,element=manager.element;element.style&&(prop=void 0,each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name),add?(manager.oldCssProps[prop]=element.style[prop],element.style[prop]=value):element.style[prop]=manager.oldCssProps[prop]||""}),add||(manager.oldCssProps={}))}var Hammer=function Hammer(element,options){return classCallCheck(this,Hammer),(options=options||{}).recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options)},SINGLE_TOUCH_INPUT_MAP=(Hammer.VERSION="2.0.8",Hammer.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[TEST_ELEMENT,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:6}],[PanRecognizer,{direction:6},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},{touchstart:INPUT_START,touchmove:2,touchend:INPUT_END,touchcancel:INPUT_CANCEL}),SingleTouchInput=function(){function SingleTouchInput(){classCallCheck(this,SingleTouchInput);var _this=possibleConstructorReturn(this,(SingleTouchInput.__proto__||Object.getPrototypeOf(SingleTouchInput)).apply(this,arguments));return _this.evTarget="touchstart",_this.evWin="touchstart touchmove touchend touchcancel",_this.started=!1,Input.apply(_this,arguments),_this}return inherits(SingleTouchInput,Input),createClass(SingleTouchInput,[{key:"handler",value:function(ev){var touches,type=SINGLE_TOUCH_INPUT_MAP[ev.type];type===INPUT_START&&(this.started=!0),this.started&&(touches=function(ev,type){var all=toArray$1(ev.touches),ev=toArray$1(ev.changedTouches);type&(INPUT_END|INPUT_CANCEL)&&(all=uniqueArray(all.concat(ev),"identifier",!0));return[all,ev]}.call(this,ev,type),type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length==0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev}))}}]),SingleTouchInput}();function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace"),e=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",log=window.console&&(window.console.warn||window.console.log);return log&&log.call(window.console,deprecationMessage,e),method.apply(this,arguments)}}var extend=deprecate(function(dest,src,merge){for(var keys=Object.keys(src),i=0;i<keys.length;)merge&&dest[keys[i]]!==undefined||(dest[keys[i]]=src[keys[i]]),i++;return dest},"extend","Use `assign`."),merge=deprecate(function(dest,src){return extend(dest,src,!0)},"merge","Use `assign`.");assign$1(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:2,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:TEST_ELEMENT,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign$1,inherit:function(child,base,properties){var base=base.prototype,childP=void 0;(childP=child.prototype=Object.create(base)).constructor=child,childP._super=base,properties&&assign$1(childP,properties)},bindFn:bindFn,prefixed:prefixed,toArray:toArray$1,inArray:inArray,uniqueArray:uniqueArray,splitStr:splitStr,boolOrFn:boolOrFn,hasParent:hasParent,addEventListeners:addEventListeners,removeEventListeners:removeEventListeners}),"function"==typeof define&&define.amd?define(function(){return Hammer}):void 0!==module&&module.exports?module.exports=Hammer:window.Hammer=Hammer}(window,document)},{}],19:[function(require,module,exports){!function(){function lookupIterator(value){return null==value?_.identity:_.isFunction(value)?value:_.property(value)}function group(behavior){return function(obj,iterator,context){var result={};return iterator=lookupIterator(iterator),each(obj,function(value,index){index=iterator.call(context,value,index,obj);behavior(result,index,value)}),result}}function flatten(input,shallow,output){return shallow&&_.every(input,_.isArray)?concat.apply(output,input):(each(input,function(value){_.isArray(value)||_.isArguments(value)?shallow?push.apply(output,value):flatten(value,shallow,output):output.push(value)}),output)}function ctor(){}function eq(a,b,aStack,bStack){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof _&&(a=a._wrapped),b instanceof _&&(b=b._wrapped);var className=toString.call(a);if(className!=toString.call(b))return!1;switch(className){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var length=aStack.length;length--;)if(aStack[length]==a)return bStack[length]==b;var aCtor=a.constructor,bCtor=b.constructor;if(aCtor!==bCtor&&!(_.isFunction(aCtor)&&aCtor instanceof aCtor&&_.isFunction(bCtor)&&bCtor instanceof bCtor)&&"constructor"in a&&"constructor"in b)return!1;aStack.push(a),bStack.push(b);var size=0,result=!0;if("[object Array]"==className){if(result=(size=a.length)==b.length)for(;size--&&(result=eq(a[size],b[size],aStack,bStack)););}else{for(var key in a)if(_.has(a,key)&&(size++,!(result=_.has(b,key)&&eq(a[key],b[key],aStack,bStack))))break;if(result){for(key in b)if(_.has(b,key)&&!size--)break;result=!size}}return aStack.pop(),bStack.pop(),result}var root=this,previousUnderscore=root._,breaker={},ArrayProto=Array.prototype,ObjProto=Object.prototype,FuncProto=Function.prototype,push=ArrayProto.push,slice=ArrayProto.slice,concat=ArrayProto.concat,toString=ObjProto.toString,hasOwnProperty=ObjProto.hasOwnProperty,nativeForEach=ArrayProto.forEach,nativeMap=ArrayProto.map,nativeReduce=ArrayProto.reduce,nativeReduceRight=ArrayProto.reduceRight,nativeFilter=ArrayProto.filter,nativeEvery=ArrayProto.every,nativeSome=ArrayProto.some,nativeIndexOf=ArrayProto.indexOf,nativeLastIndexOf=ArrayProto.lastIndexOf,ObjProto=Array.isArray,nativeKeys=Object.keys,nativeBind=FuncProto.bind,_=function(obj){return obj instanceof _?obj:this instanceof _?void(this._wrapped=obj):new _(obj)},each=(void 0!==exports?(exports=void 0!==module&&module.exports?module.exports=_:exports)._=_:root._=_,_.VERSION="1.6.0",_.each=_.forEach=function(obj,iterator,context){if(null==obj)return obj;if(nativeForEach&&obj.forEach===nativeForEach)obj.forEach(iterator,context);else if(obj.length===+obj.length){for(var i=0,length=obj.length;i<length;i++)if(iterator.call(context,obj[i],i,obj)===breaker)return}else for(var keys=_.keys(obj),i=0,length=keys.length;i<length;i++)if(iterator.call(context,obj[keys[i]],keys[i],obj)===breaker)return;return obj}),reduceError=(_.map=_.collect=function(obj,iterator,context){var results=[];return null==obj?results:nativeMap&&obj.map===nativeMap?obj.map(iterator,context):(each(obj,function(value,index,list){results.push(iterator.call(context,value,index,list))}),results)},"Reduce of empty array with no initial value"),any=(_.reduce=_.foldl=_.inject=function(obj,iterator,memo,context){var initial=2<arguments.length;if(null==obj&&(obj=[]),nativeReduce&&obj.reduce===nativeReduce)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduce(iterator,memo):obj.reduce(iterator);if(each(obj,function(value,index,list){initial?memo=iterator.call(context,memo,value,index,list):(memo=value,initial=!0)}),initial)return memo;throw new TypeError(reduceError)},_.reduceRight=_.foldr=function(obj,iterator,memo,context){var initial=2<arguments.length;if(null==obj&&(obj=[]),nativeReduceRight&&obj.reduceRight===nativeReduceRight)return context&&(iterator=_.bind(iterator,context)),initial?obj.reduceRight(iterator,memo):obj.reduceRight(iterator);var keys,length=obj.length;if(length!==+length&&(keys=_.keys(obj),length=keys.length),each(obj,function(value,index,list){index=keys?keys[--length]:--length,initial?memo=iterator.call(context,memo,obj[index],index,list):(memo=obj[index],initial=!0)}),initial)return memo;throw new TypeError(reduceError)},_.find=_.detect=function(obj,predicate,context){var result;return any(obj,function(value,index,list){if(predicate.call(context,value,index,list))return result=value,!0}),result},_.filter=_.select=function(obj,predicate,context){var results=[];return null==obj?results:nativeFilter&&obj.filter===nativeFilter?obj.filter(predicate,context):(each(obj,function(value,index,list){predicate.call(context,value,index,list)&&results.push(value)}),results)},_.reject=function(obj,predicate,context){return _.filter(obj,function(value,index,list){return!predicate.call(context,value,index,list)},context)},_.every=_.all=function(obj,predicate,context){predicate=predicate||_.identity;var result=!0;return null==obj?result:nativeEvery&&obj.every===nativeEvery?obj.every(predicate,context):(each(obj,function(value,index,list){if(!(result=result&&predicate.call(context,value,index,list)))return breaker}),!!result)},_.some=_.any=function(obj,predicate,context){predicate=predicate||_.identity;var result=!1;return null==obj?result:nativeSome&&obj.some===nativeSome?obj.some(predicate,context):(each(obj,function(value,index,list){if(result=result||predicate.call(context,value,index,list))return breaker}),!!result)}),entityMap=(_.contains=_.include=function(obj,target){return null!=obj&&(nativeIndexOf&&obj.indexOf===nativeIndexOf?-1!=obj.indexOf(target):any(obj,function(value){return value===target}))},_.invoke=function(obj,method){var args=slice.call(arguments,2),isFunc=_.isFunction(method);return _.map(obj,function(value){return(isFunc?method:value[method]).apply(value,args)})},_.pluck=function(obj,key){return _.map(obj,_.property(key))},_.where=function(obj,attrs){return _.filter(obj,_.matches(attrs))},_.findWhere=function(obj,attrs){return _.find(obj,_.matches(attrs))},_.max=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.max.apply(Math,obj);var result=-1/0,lastComputed=-1/0;return each(obj,function(value,index,list){index=iterator?iterator.call(context,value,index,list):value;lastComputed<index&&(result=value,lastComputed=index)}),result},_.min=function(obj,iterator,context){if(!iterator&&_.isArray(obj)&&obj[0]===+obj[0]&&obj.length<65535)return Math.min.apply(Math,obj);var result=1/0,lastComputed=1/0;return each(obj,function(value,index,list){index=iterator?iterator.call(context,value,index,list):value;index<lastComputed&&(result=value,lastComputed=index)}),result},_.shuffle=function(obj){var rand,index=0,shuffled=[];return each(obj,function(value){rand=_.random(index++),shuffled[index-1]=shuffled[rand],shuffled[rand]=value}),shuffled},_.sample=function(obj,n,guard){return null==n||guard?(obj=obj.length!==+obj.length?_.values(obj):obj)[_.random(obj.length-1)]:_.shuffle(obj).slice(0,Math.max(0,n))},_.sortBy=function(obj,iterator,context){return iterator=lookupIterator(iterator),_.pluck(_.map(obj,function(value,index,list){return{value:value,index:index,criteria:iterator.call(context,value,index,list)}}).sort(function(left,right){var a=left.criteria,b=right.criteria;if(a!==b){if(b<a||void 0===a)return 1;if(a<b||void 0===b)return-1}return left.index-right.index}),"value")},_.groupBy=group(function(result,key,value){_.has(result,key)?result[key].push(value):result[key]=[value]}),_.indexBy=group(function(result,key,value){result[key]=value}),_.countBy=group(function(result,key){_.has(result,key)?result[key]++:result[key]=1}),_.sortedIndex=function(array,obj,iterator,context){for(var value=(iterator=lookupIterator(iterator)).call(context,obj),low=0,high=array.length;low<high;){var mid=low+high>>>1;iterator.call(context,array[mid])<value?low=1+mid:high=mid}return low},_.toArray=function(obj){return obj?_.isArray(obj)?slice.call(obj):obj.length===+obj.length?_.map(obj,_.identity):_.values(obj):[]},_.size=function(obj){return null==obj?0:(obj.length===+obj.length?obj:_.keys(obj)).length},_.first=_.head=_.take=function(array,n,guard){if(null!=array)return null==n||guard?array[0]:n<0?[]:slice.call(array,0,n)},_.initial=function(array,n,guard){return slice.call(array,0,array.length-(null==n||guard?1:n))},_.last=function(array,n,guard){if(null!=array)return null==n||guard?array[array.length-1]:slice.call(array,Math.max(array.length-n,0))},_.rest=_.tail=_.drop=function(array,n,guard){return slice.call(array,null==n||guard?1:n)},_.compact=function(array){return _.filter(array,_.identity)},_.flatten=function(array,shallow){return flatten(array,shallow,[])},_.without=function(array){return _.difference(array,slice.call(arguments,1))},_.partition=function(array,predicate){var pass=[],fail=[];return each(array,function(elem){(predicate(elem)?pass:fail).push(elem)}),[pass,fail]},_.uniq=_.unique=function(array,isSorted,iterator,context){_.isFunction(isSorted)&&(context=iterator,iterator=isSorted,isSorted=!1);var iterator=iterator?_.map(array,iterator,context):array,results=[],seen=[];return each(iterator,function(value,index){(isSorted?index&&seen[seen.length-1]===value:_.contains(seen,value))||(seen.push(value),results.push(array[index]))}),results},_.union=function(){return _.uniq(_.flatten(arguments,!0))},_.intersection=function(array){var rest=slice.call(arguments,1);return _.filter(_.uniq(array),function(item){return _.every(rest,function(other){return _.contains(other,item)})})},_.difference=function(array){var rest=concat.apply(ArrayProto,slice.call(arguments,1));return _.filter(array,function(value){return!_.contains(rest,value)})},_.zip=function(){for(var length=_.max(_.pluck(arguments,"length").concat(0)),results=new Array(length),i=0;i<length;i++)results[i]=_.pluck(arguments,""+i);return results},_.object=function(list,values){if(null==list)return{};for(var result={},i=0,length=list.length;i<length;i++)values?result[list[i]]=values[i]:result[list[i][0]]=list[i][1];return result},_.indexOf=function(array,item,isSorted){if(null==array)return-1;var i=0,length=array.length;if(isSorted){if("number"!=typeof isSorted)return array[i=_.sortedIndex(array,item)]===item?i:-1;i=isSorted<0?Math.max(0,length+isSorted):isSorted}if(nativeIndexOf&&array.indexOf===nativeIndexOf)return array.indexOf(item,isSorted);for(;i<length;i++)if(array[i]===item)return i;return-1},_.lastIndexOf=function(array,item,from){if(null==array)return-1;var hasIndex=null!=from;if(nativeLastIndexOf&&array.lastIndexOf===nativeLastIndexOf)return hasIndex?array.lastIndexOf(item,from):array.lastIndexOf(item);for(var i=hasIndex?from:array.length;i--;)if(array[i]===item)return i;return-1},_.range=function(start,stop,step){arguments.length<=1&&(stop=start||0,start=0),step=arguments[2]||1;for(var length=Math.max(Math.ceil((stop-start)/step),0),idx=0,range=new Array(length);idx<length;)range[idx++]=start,start+=step;return range},_.bind=function(func,context){var args,bound;if(nativeBind&&func.bind===nativeBind)return nativeBind.apply(func,slice.call(arguments,1));if(_.isFunction(func))return args=slice.call(arguments,2),bound=function(){if(!(this instanceof bound))return func.apply(context,args.concat(slice.call(arguments)));ctor.prototype=func.prototype;var self=new ctor,result=(ctor.prototype=null,func.apply(self,args.concat(slice.call(arguments))));return Object(result)===result?result:self};throw new TypeError},_.partial=function(func){var boundArgs=slice.call(arguments,1);return function(){for(var position=0,args=boundArgs.slice(),i=0,length=args.length;i<length;i++)args[i]===_&&(args[i]=arguments[position++]);for(;position<arguments.length;)args.push(arguments[position++]);return func.apply(this,args)}},_.bindAll=function(obj){var funcs=slice.call(arguments,1);if(0===funcs.length)throw new Error("bindAll must be passed function names");return each(funcs,function(f){obj[f]=_.bind(obj[f],obj)}),obj},_.memoize=function(func,hasher){var memo={};return hasher=hasher||_.identity,function(){var key=hasher.apply(this,arguments);return _.has(memo,key)?memo[key]:memo[key]=func.apply(this,arguments)}},_.delay=function(func,wait){var args=slice.call(arguments,2);return setTimeout(function(){return func.apply(null,args)},wait)},_.defer=function(func){return _.delay.apply(_,[func,1].concat(slice.call(arguments,1)))},_.throttle=function(func,wait,options){function later(){previous=!1===options.leading?0:_.now(),timeout=null,result=func.apply(context,args),context=args=null}var context,args,result,timeout=null,previous=0;options=options||{};return function(){var now=_.now(),remaining=(previous||!1!==options.leading||(previous=now),wait-(now-previous));return context=this,args=arguments,remaining<=0?(clearTimeout(timeout),timeout=null,previous=now,result=func.apply(context,args),context=args=null):timeout||!1===options.trailing||(timeout=setTimeout(later,remaining)),result}},_.debounce=function(func,wait,immediate){function later(){var last=_.now()-timestamp;last<wait?timeout=setTimeout(later,wait-last):(timeout=null,immediate||(result=func.apply(context,args),context=args=null))}var timeout,args,context,timestamp,result;return function(){context=this,args=arguments,timestamp=_.now();var callNow=immediate&&!timeout;return timeout=timeout||setTimeout(later,wait),callNow&&(result=func.apply(context,args),context=args=null),result}},_.once=function(func){var memo,ran=!1;return function(){return ran||(ran=!0,memo=func.apply(this,arguments),func=null),memo}},_.wrap=function(func,wrapper){return _.partial(wrapper,func)},_.compose=function(){var funcs=arguments;return function(){for(var args=arguments,i=funcs.length-1;0<=i;i--)args=[funcs[i].apply(this,args)];return args[0]}},_.after=function(times,func){return function(){if(--times<1)return func.apply(this,arguments)}},_.keys=function(obj){if(!_.isObject(obj))return[];if(nativeKeys)return nativeKeys(obj);var key,keys=[];for(key in obj)_.has(obj,key)&&keys.push(key);return keys},_.values=function(obj){for(var keys=_.keys(obj),length=keys.length,values=new Array(length),i=0;i<length;i++)values[i]=obj[keys[i]];return values},_.pairs=function(obj){for(var keys=_.keys(obj),length=keys.length,pairs=new Array(length),i=0;i<length;i++)pairs[i]=[keys[i],obj[keys[i]]];return pairs},_.invert=function(obj){for(var result={},keys=_.keys(obj),i=0,length=keys.length;i<length;i++)result[obj[keys[i]]]=keys[i];return result},_.functions=_.methods=function(obj){var key,names=[];for(key in obj)_.isFunction(obj[key])&&names.push(key);return names.sort()},_.extend=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)obj[prop]=source[prop]}),obj},_.pick=function(obj){var copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));return each(keys,function(key){key in obj&&(copy[key]=obj[key])}),copy},_.omit=function(obj){var key,copy={},keys=concat.apply(ArrayProto,slice.call(arguments,1));for(key in obj)_.contains(keys,key)||(copy[key]=obj[key]);return copy},_.defaults=function(obj){return each(slice.call(arguments,1),function(source){if(source)for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}),obj},_.clone=function(obj){return _.isObject(obj)?_.isArray(obj)?obj.slice():_.extend({},obj):obj},_.tap=function(obj,interceptor){return interceptor(obj),obj},_.isEqual=function(a,b){return eq(a,b,[],[])},_.isEmpty=function(obj){if(null==obj)return!0;if(_.isArray(obj)||_.isString(obj))return 0===obj.length;for(var key in obj)if(_.has(obj,key))return!1;return!0},_.isElement=function(obj){return!(!obj||1!==obj.nodeType)},_.isArray=ObjProto||function(obj){return"[object Array]"==toString.call(obj)},_.isObject=function(obj){return obj===Object(obj)},each(["Arguments","Function","String","Number","Date","RegExp"],function(name){_["is"+name]=function(obj){return toString.call(obj)=="[object "+name+"]"}}),_.isArguments(arguments)||(_.isArguments=function(obj){return!(!obj||!_.has(obj,"callee"))}),"function"!=typeof/./&&(_.isFunction=function(obj){return"function"==typeof obj}),_.isFinite=function(obj){return isFinite(obj)&&!isNaN(parseFloat(obj))},_.isNaN=function(obj){return _.isNumber(obj)&&obj!=+obj},_.isBoolean=function(obj){return!0===obj||!1===obj||"[object Boolean]"==toString.call(obj)},_.isNull=function(obj){return null===obj},_.isUndefined=function(obj){return void 0===obj},_.has=function(obj,key){return hasOwnProperty.call(obj,key)},_.noConflict=function(){return root._=previousUnderscore,this},_.identity=function(value){return value},_.constant=function(value){return function(){return value}},_.property=function(key){return function(obj){return obj[key]}},_.matches=function(attrs){return function(obj){if(obj===attrs)return!0;for(var key in attrs)if(attrs[key]!==obj[key])return!1;return!0}},_.times=function(n,iterator,context){for(var accum=Array(Math.max(0,n)),i=0;i<n;i++)accum[i]=iterator.call(context,i);return accum},_.random=function(min,max){return null==max&&(max=min,min=0),min+Math.floor(Math.random()*(max-min+1))},_.now=Date.now||function(){return(new Date).getTime()},{escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}}),entityRegexes=(entityMap.unescape=_.invert(entityMap.escape),{escape:new RegExp("["+_.keys(entityMap.escape).join("")+"]","g"),unescape:new RegExp("("+_.keys(entityMap.unescape).join("|")+")","g")}),idCounter=(_.each(["escape","unescape"],function(method){_[method]=function(string){return null==string?"":(""+string).replace(entityRegexes[method],function(match){return entityMap[method][match]})}}),_.result=function(object,property){if(null!=object)return property=object[property],_.isFunction(property)?property.call(object):property},_.mixin=function(obj){each(_.functions(obj),function(name){var func=_[name]=obj[name];_.prototype[name]=function(){var args=[this._wrapped];return push.apply(args,arguments),result.call(this,func.apply(_,args))}})},0),noMatch=(_.uniqueId=function(prefix){var id=++idCounter+"";return prefix?prefix+id:id},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},/(.)^/),escapes={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},escaper=/\\|'|\r|\n|\t|\u2028|\u2029/g,result=(_.template=function(text,data,settings){settings=_.defaults({},settings,_.templateSettings);var render,matcher=new RegExp([(settings.escape||noMatch).source,(settings.interpolate||noMatch).source,(settings.evaluate||noMatch).source].join("|")+"|$","g"),index=0,source="__p+='";text.replace(matcher,function(match,escape,interpolate,evaluate,offset){return source+=text.slice(index,offset).replace(escaper,function(match){return"\\"+escapes[match]}),escape&&(source+="'+\n((__t=("+escape+"))==null?'':_.escape(__t))+\n'"),interpolate&&(source+="'+\n((__t=("+interpolate+"))==null?'':__t)+\n'"),evaluate&&(source+="';\n"+evaluate+"\n__p+='"),index=offset+match.length,match}),source+="';\n",source="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+(source=settings.variable?source:"with(obj||{}){\n"+source+"}\n")+"return __p;\n";try{render=new Function(settings.variable||"obj","_",source)}catch(e){throw e.source=source,e}if(data)return render(data,_);function template(data){return render.call(this,data,_)}return template.source="function("+(settings.variable||"obj")+"){\n"+source+"}",template},_.chain=function(obj){return _(obj).chain()},function(obj){return this._chain?_(obj).chain():obj});_.mixin(_),each(["pop","push","reverse","shift","sort","splice","unshift"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){var obj=this._wrapped;return method.apply(obj,arguments),"shift"!=name&&"splice"!=name||0!==obj.length||delete obj[0],result.call(this,obj)}}),each(["concat","join","slice"],function(name){var method=ArrayProto[name];_.prototype[name]=function(){return result.call(this,method.apply(this._wrapped,arguments))}}),_.extend(_.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}.call(this)},{}]},{},[13]);